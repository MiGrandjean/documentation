<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.3" />
<title>opsi Setup Detector</title>
<style type="text/css">
/* Sans-serif font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
div#toctitle,
span#author, span#revnumber, span#revdate, span#revremark,
div#footer {
  font-family: Arial,Helvetica,sans-serif;
}

/* Serif font. */
div.sectionbody {
  font-family: Georgia,"Times New Roman",Times,serif;
}

/* Monospace font. */
tt {
  font-size: inherit;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  font-size: inherit;
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
}

div#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  div#footer-badges { display: none; }
}

div#toc {
  margin-bottom: 2.5em;
}

div#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){asciidoc.footnotes(); asciidoc.toc(6);}
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  var cont = document.getElementById("content");
  var noteholder = document.getElementById("footnotes");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      // Use [\s\S] in place of . so multi-line matches work.
      // Because JavaScript has no s (dotall) regex flag.
      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      spans[i].innerHTML =
        "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
        "' title='View footnote' class='footnote'>" + n + "</a>]";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
}

}
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>opsi Setup Detector</h1>
<span id="author">uib gmbh</span><br />
<span id="email"><tt>&lt;<a href="mailto:info@uib.de">info@uib.de</a>&gt;</tt></span><br />
<span id="revnumber">version $Rev: $,</span>
<span id="revdate">$Date: $</span>
<div id="toc">
  <div id="toctitle">Inhaltsverzeichnis</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="opsi-setup-detector">opsi Setup Detector</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="opsi-setup-detector-introduction">Einführung</h3>
<div class="paragraph"><p>Die grundsätzlichen Schritte bei der Paketierung und Verteilung einer Software sind:
* Analyse des Setups und Erzeugen der Paket-Dateien auf der opsi Workbench
* Packen des opsi Paketes
* Installation des opsi Paketes auf dem opsi Server
* Installation der Software auf den Clients</p></div>
<div class="paragraph"><p>Der opsi Setup Detector ist ein opsi Werkzeug zur Unterstützung der Software-Paketierung. Von seiner grafischen Benutzeroberfläche können alle Schritte von der Auswahl der zu paketierenden Setup-Datei, über das Erstellen der Installationsverzeichnisse auf der opsi Workbench, bis zur Paketierung und Installation auf dem opsi Server durchgeführt werden. Hierzu arbeitet der Setup Detector mit dem Community Projekt <em>opsi Package Builder</em> zusammen.
Der opsi Setup Detector erkennt beim Öffnen einer Setup-Datei, ob es sich um einen bekanneten Installer-Typ handelt und ermittelt automatisch die verfügbaren Informationen aus der Setup-Datei.
Mit der Zeit wird durch weitere Erfahrungen mit verschiedenen Installer-Typen und Rückmeldungen der Benutzer die Fähigkeit der automatischen Erkennung verschiedener Setup-Typen sicher noch weiter wachsen.</p></div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-prerequires">Vorbedingungen für die Benutzung des opsi Setup Detectors</h3>
<div class="paragraph"><p>Der opsi Setup Detector läuft auf Windows Systemen ab Windows XP und benötigt, falls die Pakete auch gepackt und auf dem Server installiert werden sollen, das Community Projekt opsi Package Builder, welches auf dem gleichen Windows-Rechner zu installieren ist.
Weitere Informationen zum opsi Package Builder finden Sie im opsi Forum bei den opsi Community Projekten:
<a href="https://forum.opsi.org/viewforum.php?f=22">https://forum.opsi.org/viewforum.php?f=22</a></p></div>
<div class="paragraph"><p>Für die Erzeugung der Pakete ist ein Samba-Share mit Schreibberechtigung auf die opsi Workbench notwendig.
Ausserdem ist zu beachten, dass manche Software-Pakete (z.B. manche 64 Bit Software) auch für die Integration ein entsprechendes Windows-System voraussetzen. Das heißt z.B. ein Setup für eine 64bit Windows7 Software kann eventuell nicht auf einem 32bit WindowsXP paketiert werden. Das hängt im Einzelfall ab vom Verhalten des jeweiligen Setups.</p></div>
<div class="paragraph"><p>Hier nochmal die Voraussetzungen im Überblick:</p></div>
<div class="ulist"><ul>
<li>
<p>
Windows-Rechner ab Windows XP
</p>
</li>
<li>
<p>
opsi package Builder installieren und konfigurieren
</p>
</li>
<li>
<p>
Samba-Share mit Schreibrechten zur opsi Workbench
</p>
</li>
<li>
<p>
opsi Setup Detector installieren
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-activate">Inbetriebnahme des opsi Setup Detectors</h3>
<div class="paragraph"><p>Der opsi Setup Detector ist ein mit Lazarus entwickeltes Windows-Programm, das zusätzlich einige Hilfsdateien zur Analyse spezieller Setup-Formate sowie die Vorlagen-Dateien zur Erstellung eines neuen opsi Paketes benötigt. Der opsi Setup Detector mit seinen Zusatz-Dateien ist als opsi Paket verfügbar.
Nach der Installation muss noch der Samba-Share auf die opsi Workbench als Basisverzeichnis eingetragen werden und schon kann mit <em>Datei öffnen</em> eine Setup-Datei geöffnet werden, die dann automatisch analysiert wird.</p></div>
<div class="sect3">
<h4 id="opsi-setup-detector-activate-languages">Sprachunterstützung</h4>
<div class="paragraph"><p>Beim Start des Programmes wird automatisch ermittelt, unter welcher Sprache das Windows System läuft. Von Haus aus unterstützt der opsi Setup Detector Deutsch und Englisch. Weitere Sprachen können recht einfach über eine entsprechend zu übersetzende Sprachdatei nachgerüstet werden.</p></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-activate-files">Dateien des opsi Setup Detectors</h4>
<div class="paragraph"><p>Folgende Dateien sind im opsi Setup Detector Paket enthalten und werden zur Ausführung benötigt:</p></div>
<div class="ulist"><ul>
<li>
<p>
opsisetupdetector.exe - der opsi Setup Detector
</p>
</li>
<li>
<p>
extractMSI.cmd - Hilfsdatei zur automatischen Analyse von MSI-Dateien
</p>
</li>
<li>
<p>
MSIInfo.js - Hilfsdatei zur automatischen Analyse von MSI-Dateien
</p>
</li>
<li>
<p>
innounp.exe - Hilfsdatei zur automatischen Analyse von Inno Setup Paketen
</p>
</li>
<li>
<p>
innounp.htm - Hilfsdatei zur automatischen Analyse von Inno Setup Paketen
</p>
</li>
<li>
<p>
favicon.ico - opsi Icon
</p>
</li>
<li>
<p>
languages\ - Verzeichnis für die sprachspezifischen Komponenten
</p>
</li>
<li>
<p>
languages\opsisetupdetector.po - default Sprachdatei (Englisch)
</p>
</li>
<li>
<p>
languages\opsisetupdetector.de.po - Deutsche Sprachdatei
</p>
</li>
<li>
<p>
languages\Help.en.html - Englische Hilfe
</p>
</li>
<li>
<p>
languages\Help.de.html - Deutsche Hilfe
</p>
</li>
</ul></div>
<div class="paragraph"><p>Zum Erzeugen der opsi Pakete werden verschiedene Vorlagen-Dateien benötigt. Diese werden dann beim Erzeugen eines neuen Paketes in die opsi Workbench kopiert und entsprechend den Einträgen des im opsi Setup Detector angezeigten Formulars gepatcht:</p></div>
<div class="ulist"><ul>
<li>
<p>
files2opsi\OPSI\ - Vorlagen für die Paketierung-Informationen
</p>
</li>
<li>
<p>
files2opsi\OPSI\control
</p>
</li>
<li>
<p>
files2opsi\OPSI\postinst
</p>
</li>
<li>
<p>
files2opsi\OPSI\preinst
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\ - Vorlagen für die opsiscripte
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\setup.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\uninstall.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\delsub.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_advanced_exitcode.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_inno_exitcode.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_installshield_exitcode.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_installshieldmsi_exitcode.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_inno_exitcode.opsiscript
</p>
</li>
<li>
<p>
files2opsi\CLIENT_DATA\check_msi_exitcode.opsiscript
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-menu">Das Menü des opsi Setup Detektors</h3>
<div class="paragraph"><p>Das Menü am oberen linken Rand enthält die Punkte</p></div>
<div class="ulist"><ul>
<li>
<p>
Datei - (öffnet ein Untermenü, s.u.)
</p>
</li>
<li>
<p>
Hilfe - interne Hilfe aufrufen. Um die enthaltenen Links zu verwenden, kann die Hilfe-Datei <em>%ProgramFilesDir%\opsiSetupDetector\languages\Help.de.html</em> alternativ auch direkt in einem Browser angezeigt werden.
</p>
</li>
<li>
<p>
Info - Programm-Version anzeigen
</p>
</li>
</ul></div>
<div class="paragraph"><p>Der Menüpunkt <em>Datei</em> öffnet ein Untermenü mit</p></div>
<div class="ulist"><ul>
<li>
<p>
Datei öffnen und analysieren - Auswählen des zu analysiernden Setup. Dieser Menüpunkt hat die gleiche Funktion wie der <em>Datei öffnen</em> Button auf dem <em>Analysiere</em> Tab rechts unten und öffnet einen Datei Auswahl Dialog, der alle Dateien anzeigt. Der Datei Auswahl Dialog auf den jeweiligen Installer Tabs zeigt nur Dateien an mit der Endung <em>.MSI</em>(<em>MSI</em> Tab) bzw. <em>.EXE</em> (alle anderen Installer Tabs).
</p>
</li>
<li>
<p>
Schreibe Logdatei - Der Inhalt des Analyze Tab wird als Logdatei geschrieben. Der Name der erzeugten Datei entspricht <em>%TEMP%\opsitmp\opsiSetupDetector.log</em> und wird beim Erzeigen in einem Dialog angezeigt. Die Logdatei wird direkt beim Aufruf dieses Kommandos erzeugt und enthält nur die Informationen, die zum Zeitpunkt des Aufrufs im <strong>Analysiere</strong> Tab stehen.
</p>
</li>
<li>
<p>
Beenden - beendet den opsi Setup Detektor
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-analyze">Automatische Analyse eines Setup-Paketes</h3>
<div class="paragraph"><p>Nach dem Öffnen einer Setup-Datei mit <em>Datei öffnen</em> wird diese automatisch analysiert und, falls es sich um einen bekannten Installer-Typ handelt, automatisch auf den entsprechenden Tab gewechselt.
Falls der Installer-Typ nicht erkannt wird, bleibt weiterhin das <strong>Anaysiere</strong> Tab stehen. Auch wenn der Installer-Typ erkannt wurde, kann jederzeit auf das <strong>Analysiere</strong> Tab zurück gewechselt werden um zu sehen, was bei der automatischen Analyse gefunden wurde.</p></div>
<div class="paragraph"><p>Bei der Analyse einer MSI-Datei ist bereits durch die Endung MSI bekannt, dass es sich um ein MSI-Paket handelt. Einer EXE-Datei sieht man es aber nicht an der Endung an, mit welchem Installer-Typ sie erstellt wurde. Deshalb wird die EXE-Datei vom opsi Setup Detector automatisch nach bestimmten Kennungen durchsucht.
Falls die Kennung eines bekannten Installer-Typs gefunden wurde, wird direkt auf den Tab dieses Installers gewechselt.
Falls kein bekannter Setup-Typ erkannt wurde, wird die Datei nach bestimmten allgemeinen Stichworten (z.B. "Installer" oder "Setup") durchsucht und die entsprechenden Zeilen werden ausgegeben. Darin können auch kryptische Passagen und bestimmte Fehlermeldungen enthalten sein, die das Setup-Programm in bestimmten Fällen, z.B. bei aufgetretenen Fehlern während der Installation, ausgeben möchte, wie z.B.:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>o@dejDs@s@t@t@du@u@&lt;v@w@w@lx@Hy@x@x{@X|@|@@@@L@x@@Inno Setup Setup Data
Das Setup hat einen schwerwiegenden Fehler erkannt und wird abgebrochen</tt></pre>
</div></div>
<div class="paragraph"><p>Dies besagt aber nur, dass diese Zeichen innerhalb des Setups gefunden wurden und im <strong>Analysiere</strong> Tab angezeigt werden, da sie einem der verwendeten Suchmuster entsprechen. Oben kommt z.B. das Suchmuster "Setup" vor. Bei einem nicht automatisch erkannten Setup-Typ lässt sich in diesen Angaben eventuell ein Hinweis finden, um welchen Installer-Typ es sich handeln könnte.
Alle Angaben auf dem <strong>Analysiere</strong> Tab, die eingeleitet werden von:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Analyzing: F:\&lt;setup.exe&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>und abgeschlossen werden mit:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>default grep finished.</tt></pre>
</div></div>
<div class="paragraph"><p>entstammen dieser automatischen Analyse und können im Normalfall unbeachtet bleiben. Falls der Setup-Typ erkannt wurde, steht dieser unterhalb von "default grep finished". Dass ein bekannter Setup Typ erkannt wurde merkt man auch daran, dass automatisch auf den entsprechenden Tab gewechselt wurde.</p></div>
<div class="paragraph"><p>Je nach dem gefundenen Installer-Typ sind im <strong>Analysiere</strong> Tab noch weitere Informationen zu finden zur weiteren Analyse des Setups. Diese werden in den jeweiligen Kapiteln der entsprechenden Installer-Typen behandelt.</p></div>
<div class="paragraph"><p>Der Inhalt des <strong>Analysiere</strong> Tabs wird vor einer neuen Analyse gelöscht und enthält dementsprechend nur Informationen zu dem aktuellen Setup.</p></div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-embeddedmsi">Setup-EXE mit eingebettetem MSI</h3>
<div class="paragraph"><p>Bevor auf die einzelnen Installer-Typen eingegangen wird, noch ein paar allgemeine Bemerkungen zu Setup-Dateien mit eingebettetem MSI:
derzeit werden Advanced Installer oder InstallShield basierte EXE-Dateien mit eingebettetem MSI erkannt. Das MSI Paket wird automatisch entpackt und die analysierten Eigenschaften im <strong>Advanced+MSI</strong> Tab bzw. <strong>InstallShield+MSI</strong> Tab sowie zusätzlich im <strong>MSI</strong> Tab angezeigt.
Eine EXE-Datei mit eingebettetem MSI kann auch mehrere unterschiedliche MSI-Pakete enthalten, z.B. für unterschiedliche Windows-Versionen oder 32bit/64bit. Das Setup entscheidet dann meist je nach den System-Gegebenheiten automatisch, welches MSI-Paket ausgepackt und verwendet wird. In diesem Fall erhält man bei Analyse des Paketes mit dem opsi Setup Detector nur das für das aktuelle System, auf dem der opsi Setup Detector läuft, passende MSI-Paket.
Solche EXE-Dateien haben oft eine Kommandozeilen-Hilfe, die weitere Auskunft über die enthaltenen Pakete und die Aufruf-Möglichkeiten gibt. Auch kann eine Setup-EXE eventuell je nach System oder sonstigen Eigenschaften verschiedene MST-Dateien verwenden. Kurz und gut, eine Setup.EXE kann sich je nach den Umständen unterschiedlich verhalten. In den meisten Fällen braucht man lediglich den MSI Code des eingebetteten MSI für das opsi Deinstallations-Script. Hierbei ist zu beachten, dass ein MSI-Paket für 32bit und 64bit im Normalfall einen unterschiedlichen MSI Codes enthält. Das opsi Deinstallations-Script muss dann dafür sorgen, dass es alle diese MSI Codes kennt und bei der Deinstallation handhabt.
Bei solchen Paketen sollte man den opsi Setup Detector auf unterschiedlichen Plattformen laufen lassen, um alle MSI-Kennungen zu erfassen.
Wenn der opsi Setup Detector ein eingebettetes MSI findet, analysiert er dieses und zeigt die Inhalte zusätzlich im <strong>MSI</strong> Tab an. Es kann dann auch das <strong>MSI</strong> Tab als Basis für das opsi Paket genommen werden, aber im Normalfall sollte man besser die EXE-Datei nehmen, da auf diese Weise schneller eine neue Version eingebunden werden kann und die EXE-Datei eventuell auch zusätzliche Dinge tut.</p></div>
<div class="paragraph"><p>Bei der Analyse wird das MSI und andere Komponenten der EXE-Datei in das Verzeichnis <tt>%TEMP%\opsitmp</tt> entpackt. Zuvor wird eventueller anderer Inhalt gelöscht, so dass im Verzeichnis <tt>%TEMP%\opsitmp</tt> immer nur Dateien des aktuell zu analysierenden Setups zu finden sind.</p></div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-type">Unterstützte Installer-Typen</h3>
<div class="paragraph"><p>Die einzelnen Installer-Typen sind sehr unterschiedlich bezüglich der Standardisierung ihrer Struktur und automatisierten Zugänglichkeit. Bei einem MSI-Paket oder einem auf Inno-Setup basierenden Setup kann eine Menge nützlicher Informationen automatisch detektiert werden, während andere Installer-Typen, wie z.B. NSIS, keine internen Informationen des Setups zugreifbar machen. In vielen Fällen bringt die automatisierte Analyse gute Ergebnisse, aber es kann auch immer wieder Fälle geben, bei denen die automatisierte Vorgehensweise nicht funktioniert oder zumindest händige Nacharbeit erfordert. Mit zunehmenden Erfahrungen beim Einsatz wird der opsi Setup Detector seine automatisierten Fähigkeiten mit der Zeit erweitern.</p></div>
<div class="paragraph"><p>Da MSI-Pakete der wichtigste und am meisten verwendete Installer Typ sind, folgt nach dem <strong>Analysiere</strong> Tab der <strong>MSI</strong> Tab, danach alle weiteren Installer Typ Tabs in alphabetischer Reihenfolge.</p></div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-msi">Installer-Typ MSI</h4>
<div class="paragraph"><p>MSI-Dateien sind das Installations-Datenformat des Microsoft Windows Installers.
Setups vom Installer-Typ MSI sind bereits an der Endung MSI als solche zu erkennen. Das Paketformat ist standardisiert, so dass der opsi Setup Detector automatisch weitere Informationen aus dem Paket auslesen und im <strong>MSI</strong> Tab, auf den automatisch gewechselt wird, anzeigen kann. Die im <strong>Analysiere</strong> Tab angezeigten Informationen sehen bei einem MSI-Paket z.B. so aus:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Analyzing MSI: F:\Setups\MSI\7-zip\7-Zip.msi

Microsoft (R) Windows Script Host, Version 5.8
Copyright (C) Microsoft Corporation 1996-2001. Alle Rechte vorbehalten.

MSI file: F:\uib\setupdetector\Setups\MSI\7-zip\7-Zip.msi
Manufacturer: Igor Pavlov
ProductName: 7-Zip 4.57
ProductVersion: 4.57.00.0
ProductCode: {23170F69-40C1-2701-0457-000001000000}
UpgradeCode: {23170F69-40C1-2701-0000-000004000000}
MSI file size is: 0,9 MB
Estimated required space is: 5,2 MB

get_MSI_info finished</tt></pre>
</div></div>
<div class="paragraph"><p>Diese Informationen werden aus dem MSI-Paket gelesen und automatisch in die einzelnen Felder des <strong>MSI</strong> Tabs übernommen. Diese Angaben werden benötigt zum Patchen der opsi Installations-Scripte:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>MSI Datei:</strong> Name der geöffneten MSI Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der aus dem MSI Paket ausgelesene Name der zu installierenden Software. Diesen Namen möchte man wahrscheinlich im Normalfall beibehalten.
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die ausgelesene Version der zu installierenden Software. Auch diese Angabe möchte man wohl in vielen Fällen beibehalten. Sie darf allerdings nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>MSI Produkt Code:</strong> der aus dem Paket ausgelesene Produkt-Code, welcher für das Deinstallations-Script benötigt wird. Vorsicht: ein MSI-Paket für 32bit und 64bit hat normalerweise einen jeweils unterschiedlichen Produkt Code.
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert stammt nicht aus dem MSI-Paket, sondern ist geschätzt als sechsmal die Größe der MSI-Datei und sollte gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Größe MSI:</strong> die ermittelte Größe des MSI-Paketes.
</p>
</li>
<li>
<p>
<strong>MST Datei:</strong> wird im gleichen Verzeichnis (also dort, wo die MSI-Datei liegt) eine MST-Datei (Transform-Datei) gefunden, wird diese eingetragen und beim Aufruf des Setup verwendet. Gegebenenfalls kann mit dem <em>Auswahl</em>-Button rechts neben dem Feld eine andere MST-Datei gewählt werden oder durch Entfernen des MST Datei-Häkchens vor dem Feld die Verwendung der MST-Datei ausgeschaltet werden.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>license=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Im Falle einer EXE-Datei mit eingebettetem MSI wird das MSI Paket automatisch extrahiert und die gefundenen Informationen zusätzlich zum Tab der EXE-Date (<strong>Advanced+MSI</strong> oder <strong>InstallShied+MSI</strong>)ebenfalls hier im <strong>MSI</strong> Tab angezeigt.</p></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-advancedmsi">Installer-Typ Advanced+MSI</h4>
<div class="paragraph"><p>Der Advanced Installer ist ein Werkzeug zur Erstellung von MSI-Paketen, die auch in  EXE-Dateien eingebettet sein können. Erkennt der opsi Setup Detektor eine EXE-Datei als ein mit Advanced Installer eingebettetes MSI-Paket, wird die MSI-Datei automatisch aus der EXE-Datei extrahiert und analysiert und die gefundenen Informationen im Tab <strong>Advanced+MSI</strong> angezeigt. Die entsprechenden Informationen werden zusätzlich auch im <strong>MSI</strong> Tab eingetragen. Nähere Angaben zum <strong>MSI</strong> Tab siehe Kapitel <a href="#opsi-setup-detector-type-msi">[opsi-setup-detector-type-msi]</a>.</p></div>
<div class="paragraph"><p>Beim automatischen Auspacken einer eingebetteten MSI-Datei wird im <strong>Analysiere</strong> Tab Folgendes angezeigt:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>xxxxxxxxxxxxxxxxxxxxxxxxx
Analyzing AdvancedMSI Setup:
F:\Setups\AdvancedMSI\Phase5\phase562install.exe
Analyzing MSI from Setup
F:\Setups\AdvancedMSI\Phase5\phase562install.exe
cmd.exe /C "F:\Setups\AdvancedMSI\Phase5\phase562install.exe" /extract:e:\Temp\opsitmp\
!! PLEASE WAIT !!
!! PLEASE WAIT !! Extracting and analyzing MSI ...
!! PLEASE WAIT !!
e:\Temp\opsitmp\*.msi
Analyzing MSI: e:\Temp\opsitmp\phase5.msi</tt></pre>
</div></div>
<div class="paragraph"><p>Das MSI wird in das Verzeichnis =%TEMP%\opsitmp= extrahiert und analysiert. Mit dem Ergebnis werden die Felder des <strong>Advanced+MSI</strong> Tab gefüllt:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Setup-Datei:</strong> Name der analysierten Setup-Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der aus dem MSI Paket ausgelesene Name der zu installierenden Software. Diesen Namen möchte man wahrscheinlich im Normalfall beibehalten.
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die ausgelesene Version der zu installierenden Software. Auch diese Angabe möchte man wohl in vielen Fällen beibehalten. Sie darf allerdings nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>MSI Produkt Code:</strong> der aus dem Paket ausgelesene Produkt-Code, welcher für das Deinstallations-Script benötigt wird. Vorsicht: ein Advanced-Installer-Paket kann unterschiedliche MSI-Pakete mit unterschiedlichem MSI Produkt Code für z.B. 32bit und 64bit enthalten und es hängt vom System des Paketierungs-PCs ab, welches MSI-Paket ausgepackt und analysiert wird. Meist kann ein 64bit-Paket nicht auf einem 32bit-Rechner entpackt werden. Zur Paketierung einer 64bit-Software wird somit auch ein 64bit-Paketierung-Rechner gebraucht.
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert ist geschätzt als sechsmal die Größe der Setup-Datei und kann gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Dateigröße:</strong> die Größe der Setup-Datei.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>$LicenseRequired$=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Signatur Advanced+MSI:</strong> bei der automatischen Erkennung einer Advanced+MSI-Datei wird in der EXE-Datei gesucht nach dem Marker:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>name="microsoft.windows.advancedinstallersetup</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-innosetup">Installer-Typ Inno Setup</h4>
<div class="paragraph"><p>Mit Inno Setup erstellte EXE-Dateien sind weitgehend standardisiert und enthalten eine spezifische Datei mit Namen <em>install_script.iss</em>, die automatisch aus der EXE-Datei extrahiert und analsiert werden kann. Mit den ermittelten Informationen werden die Felder des <strong>Inno Setup Tab</strong> gefüllt und dieser angezeigt.
Wenn man zurück in den <strong>Analysiere</strong> Tab klickt, sieht man ungefähr folgende Angaben:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>............................................
Analyzing: F:\Setups\Inno\openssl\Win32OpenSSL_Light-1_0_0i.exe
stringsgrep started (verbose:false, skipzero:false)
found string "&lt;description&gt;Inno Setup&lt;/description&gt;"
detected Inno Setup
stringsgrep completed (verbose:false, skipzero:false)
............................................
Analyzing Inno-Setup:
extract install_script.iss from F:\Setups\Inno\openssl\Win32OpenSSL_Light-1_0_0i.exe to
C:\ProgramData\opsi setup detector\INNO\Win32OpenSSL_Light-1_0_0i\install_script.iss
"E:\Program Files (x86)\opsiSetupDetector\innounp.exe" -x -a -y -d"C:\ProgramData\opsi setup detector\INNO\Win32OpenSSL_Light-1_0_0i" F:\Setups\Inno\openssl\Win32OpenSSL_Light-1_0_0i.exe install_script.iss
; Version detected: 5402
#66 install_script.iss
C:\ProgramData\opsi setup detector\INNO\Win32OpenSSL_Light-1_0_0i\install_script.iss
........
[Setup]
AppName=OpenSSL Light (32-bit)
AppVerName=OpenSSL 1.0.0i Light (32-bit)
AppPublisher=OpenSSL Win32 Installer Team
AppPublisherURL=http://www.openssl.org
AppSupportURL=http://www.slproweb.com
AppUpdatesURL=http://www.slproweb.com/products/Win32OpenSSL.html
DefaultDirName={sd}\OpenSSL-Win32
DefaultGroupName=OpenSSL
OutputBaseFilename=Win32OpenSSL_Light-1_0_0i
Compression=bzip2
........
Setup file size is: 1,9 MB
Estimated required space is: 11,1 MB
........
get_inno_info finished
Inno Setup detected</tt></pre>
</div></div>
<div class="paragraph"><p>Die Informationen aus <em>install_script.iss</em> werden automatisch in die einzelnen Felder des <strong>Inno Setup</strong> Tabs übernommen und dann verwendet zum Patchen der opsi Installations-Scripte:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Setup-Datei:</strong> Name der analysierten Setup-Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der aus <em>install_script.iss</em> ausgelesene Name der zu installierenden Software. Diesen Namen möchte man wahrscheinlich im Normalfall beibehalten.
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die ausgelesene Version der zu installierenden Software. Auch diese Angabe möchte man wohl in vielen Fällen beibehalten. Sie darf allerdings nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>Install. Verzeichnis:</strong> dies ist der Name des Verzeichnisses, in das die Software auf dem Client installiert wird. Dieses wird gebraucht zum Patchen des Deinstallations-Skriptes. Das Installations-Verzeichnis wird aus <em>install_script.iss</em> ausgelesen und kann in vielen Fällen direkt verwendet werden. Manchmal kann die Angabe des Installations-Verzeichnisses auch Inno Setup-spezifische Konstanten und Variablen enthalten, die in geschweiften Klammern angegeben sind. Einige der Inno Setup Variablen werden automatisch in opsi Syntax übersetzt, z.B.
Es sind aber auch andere Einträge möglich. Hier ist dann händige Nacharbeit angesagt, so dass in diesem Feld nur Bezeichner stehen, die vom opsi Installer (Winst) verstanden werden.
In obigem Fall wäre das z.B.: %Systemdrive%\lazarus
Eventuell kann hierzu auch der <em>install_script.iss</em> Eintrag <em>UninstallDisplayName</em> ausgewertet werden.
Eine Beschreibung der Inno Setup Variablen ist in der Inno Setup Hilfe zu finden, z.B. <a href="http://www.jrsoftware.org/ishelp/index.php">http://www.jrsoftware.org/ishelp/index.php</a>
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert stammt nicht aus der <em>install_script.iss</em>, sondern ist geschätzt als sechsmal die Größe der Setup-Datei und sollte gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Dateigröße:</strong> die ermittelte Größe der Setup-Datei.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>$LicenseRequired$=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Signatur Inno Setup:</strong> bei der automatischen Erkennung einer Inno Setup-Datei wird in der EXE-Datei gesucht nach dem Marker:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;description&gt;inno setup&lt;/description&gt;</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-installshield">Installer-Typ InstallShield</h4>
<div class="paragraph"><p>Mit Installshield erstellte EXE-Dateien sind für eine automatisierte Analyse nicht zugänglich. Es kann lediglich automatisch erkannt werden, dass es sich um ein Installshield Setup handelt. Daher werden die vorgeschlagenen Werte aus dem Namen der Setup-Datei erstellt. Wenn diese Datei lediglich <em>Setup.exe</em> heißt, wird in den Feldern auch nur <em>Setup</em> eingetragen. Hinzu kommt noch, dass es von der jeweiligen Version des verwendeten Installshield abhängt, welche Aufruf-Parameter die Setup-Datei sowie das Deinstallations-Programm akzeptieren. Bei einem Installshield-Paket ist also weitgehend Handarbeit angesagt. Der erste Test könnte darin bestehen, die Aufrufparameter des Setup zu ermitteln, z.B. durch <em>Setup.exe -?</em>.
Da mit InstallShield erstellte Pakete inzwischen kaum mehr reines InstallShield, sondern zunehmend interne MSI-Pakete enthalten, kommen bei der Paketierung reine InstallShield-Pakete kaum mehr vor, was den Paketierer in Zukunft von einem chronischen Sorgenkind befreit.</p></div>
<div class="paragraph"><p>Wenn man zurück in den <strong>Analysiere</strong> Tab klickt, sieht man ungefähr folgende Angaben:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>.....................................
Analyzing: F:\uib\setupdetector\Setups\InstallShield\viclient\VMware-viclient.exe
stringsgrep started (verbose:false, skipzero:false)
found string "InstallShield"
detected InstallShield Setup
stringsgrep completed (verbose:false, skipzero:false)
.....................................
Analyzing InstallShield-Setup:
Setup file size is: 32,1 MB
Estimated required space is: 192,6 MB
........
get_InstallShield_info finished
InstallShield Setup detected</tt></pre>
</div></div>
<div class="paragraph"><p>Die einzelnen Felder des <strong>InstallShield</strong> Tab sind:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Setup-Datei:</strong> Name der analysierten Setup-Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der Name der zu installierenden Software. Dieser muss evtl. händig korrigiert werden
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die aus dem Name der Setup-Datei ermittelte Versionsnummer muss wahrscheinlich händig korrigiert werden. Sie darf nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>Install. Verzeichnis:</strong> dies ist der Name des Verzeichnisses, in das die Software auf dem Client installiert wird. Dieses wird gebraucht zum Patchen des Deinstallations-Skriptes und muss händig eingetragen werden.
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert ist geschätzt als sechsmal die Größe der Setup-Datei und sollte gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Dateigröße:</strong> die ermittelte Größe der Setup-Datei.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>$LicenseRequired$=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Signatur InstallShield:</strong> bei der automatischen Erkennung einer InstallShield-Datei ohne eingebettetes MSI wird in der EXE-Datei gesucht nach dem Marker:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;description&gt;InstallShield.Setup&lt;/description&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>ohne dass der Marker für ein eingebettetes MSI gefunden wird. Falls auch der Marker für ein eingebettetes MSI gefunden wird, handelt es sich um ein <strong>InstallShield+MSI</strong> (s.u.).</p></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-installshieldmsi">Installer-Typ InstallShield+MSI</h4>
<div class="paragraph"><p>Mit InstallShield erstellte Software-Pakete enthalten meist intern eine (oder mehrere?) MSI-Dateien. Um die MSI-Datei zu extrahieren, wird ein Batch gestartet, der das Setup startet und zehn Sekunden wartet, welche MSI-Datei beim Starten ausgepackt wird. Dann wird der Setup-Task abgeschossen.
Das extrahierte MSI-Paket wird dann automatisch analysiert und die Informationen in den <strong>InstallShield+MSI</strong> Tab sowie den <strong>MSI</strong> Tab geschrieben.
Hier hängt es eventuell auch von der jeweiligen EXE-Datei ab, ob sie ein und wenn ja welches MSI-Paket auspackt. Eventuell packt sie keines aus, eil das Betriebssystem unpassend ist oder weil erst noch an der GUI eine Frage beantwortet werden muss, bevor ein MSI ausgepackt wird. Falls die automatische Extrahierung nicht klappt, sollte das MSI händig ausgepackt werden und als MSI analysiert werden. Diese Angaben können dann in den <strong>InstallShield+MSI</strong> Tab über tragen werden.</p></div>
<div class="paragraph"><p>Im <strong>Analysiere</strong> Tab sind typischerweise solche Einträge zu finden:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>.....................................
Analyzing: F:\Setups\Installshield-MSI\javavm\jre-6u22-windows-x64.exe
stringsgrep started (verbose:false, skipzero:false)
found strings "Installer,MSI,Database" and "InstallShield"
detected InstallShield+MSI Setup (InstallShield with embedded MSI)
found strings "Installer,MSI,Database" and "InstallShield"
detected InstallShield+MSI Setup (InstallShield with embedded MSI)
stringsgrep completed (verbose:false, skipzero:false)
.....................................
Analyzing InstallShield+MSI Setup: F:\Setups\Installshield-MSI\javavm\jre-6u22-windows-x64.exe
Analyzing MSI from InstallShield Setup F:\Setups\Installshield-MSI\javavm\jre-6u22-windows-x64.exe
cmd.exe /C E:\Program Files (x86)\opsiSetupDetector\extractMSI.cmd "F:Setups\Installshield-MSI\javavm\jre-6u22-windows-x64.exe"
!! PLEASE WAIT !!
!! PLEASE WAIT !! Extracting and analyzing MSI ...
!! PLEASE WAIT !!
e:\Temp\opsitmp\*.msi
Analyzing MSI: e:\Temp\opsitmp\phase5.msi
cmd.exe /C cscript.exe "E:\Program Files (x86)\opsiSetupDetector\msiinfo.js" "e:\Temp\opsitmp\phase5.msi"
........
Microsoft (R) Windows Script Host, Version 5.8
Copyright (C) Microsoft Corporation 1996-2001. Alle Rechte vorbehalten.

MSI file: e:\Temp\opsitmp\phase5.msi
Manufacturer: Systemberatung Schommer
ProductName: Phase 5 HTML-Editor
ProductVersion: 5.6.2.3
ProductCode: {20B1B020-DEAE-48D1-9960-D4C3185D758B}
UpgradeCode: {C63B6E47-6A28-44B6-A2C9-2BF084491FAD}
MSI file size is: 0,3 MB
Estimated required space is: 1,7 MB
........
get_MSI_info finished
Setup file size is: 15,4 MB
Estimated required space is: 92,7 MB
........
get_InstallShield_info finished
InstallShield+MSI Setup detected</tt></pre>
</div></div>
<div class="paragraph"><p>Falls die automatische Extrahierung des MSI geklappt hat, werden die gefundenen Werte automatisch in den <strong>InstallShield+MSI</strong> Tab eingetragen:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Setup-Datei:</strong> Name der analysierten Setup-Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der aus dem MSI Paket ausgelesene Name der zu installierenden Software. Diesen Namen möchte man wahrscheinlich im Normalfall beibehalten.
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die ausgelesene Version der zu installierenden Software. Auch diese Angabe möchte man wohl im Normalfall beibehalten. Sie darf nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>MSI Produkt Code:</strong> der aus dem Paket ausgelesene Produkt-Code, welcher für das Deinstallations-Script benötigt wird. Vorsicht: ein MSI-Paket kann unterschiedliche MSI Produkt Codes für z.B. 32bit und 64bit enthalten und es hängt vom System des Paketierungs-PCs ab, welches MSI-Paket ausgepackt und analysiert wird. Meist kann ein 64bit-Paket nicht auf einem 32bit-Rechner entpackt werden. Zur Paketierung einer 64bit-Software wird somit auch ein 64bit-Paketierung-Rechner gebraucht.
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert ist geschätzt als sechsmal die Größe der Setup-Datei und kann gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Dateigröße:</strong> die Größe der Setup-Datei.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>$LicenseRequired$=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Signatur InstallShield+MSI:</strong> bei der automatischen Erkennung einer InstallShield-Datei mit eingebettetem MSI wird in der EXE-Datei gesucht nach dem Marker für InstallShield und dem marker für ein eingebettetes MSI:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>&lt;description&gt;InstallShield.Setup&lt;/description&gt;
...
installer,msi,database</tt></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="opsi-setup-detector-type-nsis">Installer-Typ NSIS</h4>
<div class="paragraph"><p>NSIS Pakete zeichnen sich insbesondere dadurch aus, dass sie kompakt und schnell sind. Allerdings ist es dadurch nicht möglich, dem Paket automatisiert nähere Angaben zu entlocken. Ausser der Erkennung, dass es sich um ein NSIS-Paket handelt, können alle weiteren Informationen lediglich aus dem Namen der Setup-Datei vorgeschlagen werden. Hier ist also händige Nacharbeit angesagt.</p></div>
<div class="paragraph"><p>Die Einträge im <strong>Analysiere</strong> Tab sehen typischerweise so aus:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>...................................
Analyzing: F:\Setups\NSIS\7z920\7z920.exe
stringsgrep started (verbose:false, skipzero:false)
found string "Nullsoft.NSIS.exehead"
detected NSIS Setup
stringsgrep completed (verbose:false, skipzero:false)
...................................
Analyzing NSIS-Setup:
Setup file size is: 1,1 MB
Estimated required space is: 6,4 MB
........
get_nsis_info finished
NSIS (Nullsoft Install System) detected</tt></pre>
</div></div>
<div class="paragraph"><p>Die Bedeutung der einzelnen Felder des <strong>NSIS</strong> Tab:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Setup-Datei:</strong> Name der analysierten Setup-Datei
</p>
</li>
<li>
<p>
<strong>opsi Product ID:</strong> dies ist der Name des zu erzeugenden opsi Paketes und wird aus dem weiter unten stehenden Produkt Namen erzeugt, wobei Leerzeichen und andere ungültigen Zeichen durch ein <em>-</em> ersetzt werden. Die vorgeschlagene opsi Product ID kann natürlich geändert werden.
</p>
</li>
<li>
<p>
<strong>Produkt Name:</strong> der Name der zu installierenden Software. Dieser muss evtl. händig korrigiert werden
</p>
</li>
<li>
<p>
<strong>Produkt Version:</strong> die aus dem name der Setup-Datei ermittelte Versionsnummer muss wahrscheinlich händig korrigiert werden. Sie darf nur Ziffern und Punkte enthalten, da sie für die Versionierung des opsi Paketes verwendet wird.
</p>
</li>
<li>
<p>
<strong>Install. Verzeichnis:</strong> dies ist der Name des Verzeichnisses, in das die Software auf dem Client installiert wird. Dieses wird gebraucht zum Patchen des Deinstallations-Skriptes und muss händig eingetragen werden.
</p>
</li>
<li>
<p>
<strong>erforderlich:</strong> dieser vorgeschlagene Wert ist geschätzt als sechsmal die Größe der Setup-Datei und sollte gegebenenfalls angepasst werden. Bei der Installation auf dem Client prüft das setup.opsiscript, ob entsprechend dieser Angabe genügend Plattenplatz vorhanden ist.
</p>
</li>
<li>
<p>
<strong>Dateigröße:</strong> die ermittelte Größe der Setup-Datei.
</p>
</li>
<li>
<p>
<strong>Beschreibung:</strong> In diesem Feld wird als Vorgabe der Produkt Name vorgegeben und sollte mit weiteren Hinweisen ergänzt werden, die dann als Produktbeschreibung des opsi Paketes gesetzt werden.
</p>
</li>
<li>
<p>
<strong>Lizenz pflichtig:</strong> Wenn dieses Häkchen gesetzt wird, wird beim Patchen des opsiscripts <em>$LicenseRequired$=true</em> gesetzt.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Signatur NSIS:</strong> bei der automatischen Erkennung einer NSIS Setup-Datei wird in der EXE-Datei gesucht nach einem der Marker:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Nullsoft.NSIS.exehead
...
Nullsoft Install System</tt></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="opsi-setup-detector-create">Erzeugen eines neuen opsi Paketes</h3>
<div class="paragraph"><p>Wenn das Setup analysiert und die Felder des entsprechenden Tab gefüllt sind, kann mit dem Button <em>Erzeuge opsi Paket</em> (rechts unten) das neue Produkt erzeugt werden.</p></div>
<div class="paragraph"><p><strong>Achtung:</strong></p></div>
<div class="ulist"><ul>
<li>
<p>
als <em>Basisverzeichnis</em> muss ein beschreibbarer Share auf die opsi Workbench eingetragen sein
</p>
</li>
<li>
<p>
aus Sicherheitsgründen kann ein opsi Paket nur dann neu erzeugt werden, wenn es noch nicht vorhanden ist. Falls ein bestehendes Paket überschrieben werden soll, muss zuerst das Verzeichnis von der opsi Workbench gelöscht werden.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Links neben dem Button 'Erzeuge opsi Paket&#8217;befinden sich drei mögliche Auswahl Optionen, die sich auf die Funktion des Buttons beziehen:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>opsi Paket erzeugen:</strong> falls noch nicht vorhanden, wird das Verzeichnis für das neue opsi Paket erzeugt und die entsprechenden Dateien erstellt und gepatcht. Es wird kein Paket gebaut.
</p>
</li>
<li>
<p>
<strong>opsi Paket erzeugen und opsi Packet Builder starten:</strong> wie oben werden das Verzeichnis und die Dateien erzeugt und dann zum Packen und installieren der <em>opsi Packet Builder</em> gestartet. Die Paket Daten werden beim Aufruf in diesen übernommen und das Paket kann gebaut und installiert werden. Danach sollte der <em>opsi Packet Builder</em> wieder geschlossen werden, damit er für den nächsten Aufruf neu gestartet werden kann.
</p>
</li>
<li>
<p>
<strong>erzeugen und auto -build -install -quiet:</strong> wie oben werden das Verzeichnis und die Dateien erzeugt und dann zum Packen und installieren der <em>opsi Packet Builder</em> gestartet. Die Paket Daten werden beim Aufruf in diesen übernommen und das Paket wird automatisch gebaut und installiert, falls die entsprechenden Häkchen gesetzt sind. Wenn z.B. das Paket nur gepackt, aber nicht installiert werden soll, kann das Häkchen bei <strong>install</strong> entfernt werden. Zusätzlich kann das Häkchen bei <strong>quiet</strong> gesetzt werden, dann werden die angewählten Funktionen automatisch ausgeführt, ohne dass die Benutzeroberfläche des <em>opsi Packet Builders</em> angezeigt wird. Ansonsten sollte der <em>opsi Packet Builder</em> dann wieder geschlossen werden, damit er für den nächsten Aufruf neu gestartet werden kann.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Zu Installation, Konfiguration und Bedienung des Community Projektes <em>opsi Packet Builder</em> siehe <a href="https://forum.opsi.org/viewforum.php?f=22">https://forum.opsi.org/viewforum.php?f=22</a></p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version $Rev: $<br />
Letzte Änderung 2013-10-23 21:38:49 CEST
</div>
</div>
</body>
</html>
