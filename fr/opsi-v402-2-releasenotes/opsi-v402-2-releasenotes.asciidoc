////
; Copyright (c) uib gmbh (www.uib.de)
; Cette documentation appartient à uib
; et publié sous licence Creative Commons by-sa allemande
; voir:
; http://creativecommons.org/licenses/by-sa/3.0/de/
; http://creativecommons.org/licenses/by-sa/3.0/de/legalcode
; anglais:
; http://creativecommons.org/licenses/by-sa/3.0/
; http://creativecommons.org/licenses/by-sa/3.0/legalcode
; 
; crédits: http://www.opsi.org/credits/
////


:Author:    OpenSides sprl
:Email:     opsi@opensides.be
:Date:      08.10.2012
:Revision:  4.0.2
:doctype:		book

// Include common opsi terms
include::../common/opsi_terms.asciidoc[]

= opsi version 4.0.2 (Partie 2) Notes de version

// Include common opsi copyright
include::../common/opsi_manual_copyright.asciidoc[]

[[opsi-402-2-releasenotes-overview]]
== Vue d'ensemble des nouvelles fonctionnalités

La deuxième partie de la release opsi 4.0.2 est riche en nouvelles fonctionnalités et améliorations. Voici un aperçu:

* opsi 4.0.2 fonctionne avec les distributions Linux suivantes:

** Ubuntu 12.04

** Redhat 6

** CentOS 6

** UCS 3.0 (avec digitec-opsi-listener)

** OpenSuse 12.1

** OpenSuse 12.2

* Une nouvelle opsi-VM préconfiguré basée sur Ubuntu 12.04 avec le connecteur opsi-Nagios préconfiguré.

Les instructions d'installation pour toutes les distributions Linux prises en charge et la VM peuvent être trouvées dans le guide 'opsi-getting-started'.

* opsi-configed

** Une nouvelle fonctions de recherche sur le client avec des fonctionnalités très avancées +
Voir ci-dessous pour plus d'informations

** Les recherches peuvent être stockés et exécutés plusieurs fois

** Arborescence des répertoires dans TreeView +
Sous 'Directory', un arbre hiérarchique peut être créé pour la gestion des clients.  Contrairement à 'groups', chaque client doit être exactement à un endroit dans 'Directory'.

** La description du groupe sera affiché comme une bulle d'aide.

** Les différences entre les valeurs par défaut des clients et la valeur des propriétés spécifiques de l'hôte,pour un produit, sont affichés en gras.

** Si la version d'un client diffère de celle sur le serveur, l'information de version est affiché en couleur.

** 'Nom du produit' est désormais une colonne supplémentaire dans les onglets 'Configuration produit' et 'Produits Netboot', et il est configurable.

** Appuyant sur 'Ré-initialiser les produits locaux' dans le menu contextuel de l'onglet Client, vous supprimerez toutes les informations sur les produits installés sur ce client.

** Les valeurs de la colonne 'Rapport' peuvent être remis à zéro dans les onglets 'Configuration produit' et 'Produits Netboot'. +
Par exemple, la colonne 'Rapport' peut être réinitialisé manuellement après que le statut de 'failed' a été signalée.  

** Les demandes de connexion et les demandes des séances d'information sont décalés dans les discussions, de sorte que des connexions "suspendu" sont évités dans opsi-configed.

** Il y a une case à cocher dans la fenêtre de connexion au service Web qui établit les communications avec le format compressé gzip.

* Inventaire matériel

** 'Dell Express Code' est maintenant déterminée pour les ordinateurs 'Dell'.

** L'inventaire matériel peut être étendue en appelant des méthodes spéciales. Voir la description ci-dessous.

* Intégration pilote +
Les packages de pilotes sont automatiquement assignés à des ordinateurs basés sur le modèle de données du vendeur et de l'inventaire du matériel. Voir les descriptions ci-dessous.

* Il y a un fichier de configuration dans /etc/opsi/opsi.conf, qui contrôle l'accès Samba 4.

* Produits Netboot Windows

** Correctif de sécurité pour la version WinPE

** Adapté pour l'intégration avancé des pilotes

* Détecteur de configuration opsi

* opsi-winst: +
Il existe une variété d'extensions, qui sont décrites ci-dessous.

[[opsi-402-2-releasenotes-installation]]
== Remarques sur l'installation

Les produits qui sont publiés dans le cadre du présent communiqué sont dépendants les uns des autres.  Vous ne devriez pas essayer d'installer une seule pièce sans les autres parties.

Aucune procédure spéciale n'est requise lors de l'installation. L'installation se déroule durant les mises à jour du serveur et des produits opsi.

Le serveur doit être mis à jour avant les produits opsi.

[source,prompt]
----
cd /home/opsiproducts
mkdir opsi402-2
cd opsi402-2
wget -r -l1 -nc -nd -A "*.opsi" http://download.uib.de/opsi4.0/testing/opsi402-2/products/
opsi-package-manager -i *.opsi
----
Si la commande wget échoue, http_proxy devrait probablement être mis à http_proxy=http://192.168.1.5:8080/

Si vous avez un dépôts multiples, vous devez mettre à niveau le serveur avant la mise à niveau des dépôts.  

[[opsi-manual-configuration-tools-opsi-configed]]
== Outil: L'interface de gestion '{opsi-configed}'

[[opsi-manual-configuration-tools-opsi-configed-client-selection-selecting]]
=== Sélection des clients

La liste des clients peut avoir un ou plusieurs clients.  Cela permet le traitement de plusieurs clients en même temps. 

La liste des clients qui sont affichés dans l'onglet 'Selection des clients' peut être limitée en utilisant l'icône entonnoir ou le menu déroulant 'Sélection / Montrer seulement les clients sélectionnés'. 

La fonction 'enregistrer les clients sélectionnés en tant que groupe' a été abandonnée. Vous pouvez utiliser la souris et ajoutez les clients sélectionnés à un groupe existant
en les faisant glisser dans un groupe existant qui est affiché dans l'arborescence.

Dans la boîte de dialogue de sélection des clients (via le menu «Sélection / Préciser la recherche») les clients peuvent être sélectionnés en utilisant une variété de critères basés sur leurs configurations.

.'{opsi-configed}': dialogue de sélection
image::../images/configed_clientselection.png["{opsi-configed}: Définir la fenêtre de recherche des clients", scaledwidth="50%"]

Par exemple, il est possible de rechercher des produits opsi installés ainsi que des logiciels tels que trouvés par l'audit logiciel d'OPSI (swaudit). Vous pouvez ainsi rechercher les 
PC satisfaisant certaines conditions matérielles. Les critères peuvent être combinés par des opérateurs logiques 'and' ou 'or' et aussi être négatif. 
Les chaînes de recherche peuvent être donnés sous forme de chaînes fixes combinés avec des astérisques '*' en tant que symboles génériques. 

Les définitions de recherche peuvent être enregistrés, puis de nouveau utilisé par le menu 'Sélection / Utilisez définition de recherche sauvegardée'.

.'{opsi-configed}': Recherches sauvegardées
image::../images/configed_clientselection2.png["{opsi-configed}: Recherches sauvegardées", scaledwidth="50%"]

Il est également possible d'exécuter une recherche enregistrée à partir de la ligne de commande lorsque l'éditeur de opsi-configed est lancé.  En incluant le drapeau "-qs" et le nom de la recherche enregistrée, l'éditeur de configuration démarre 
avec les résultats de la recherche sauvegardée.  Si le nom est omis, une liste de recherches disponibles seront affichés.  

[[opsi-402-2-releasenotes-driverintegration]]
== Les extensions à l'intégration des pilotes 

Le chapitre sur l'intégration des pilotes dans 'opsi-getting-started-manuel' a été révisée.  Plus spécifiquement, le chapitre décrit les nouvelles fonctions de 'Les pilotes qui seront automatiquement attribués aux ordinateurs étant donné les les champs d'inventaire <vendeur> / <modèle>'.

[[opsi-getting-started-firststeps-osinstall-driverintegration]]
=== Intégration simplifiée des pilotes lors de l'installation automatique de Windows

Si un groupe d'ordinateurs ont des pilotes qui ne font pas partie de l'installation par défaut de Windows, il est préférable de mettre ces ordinateurs dans un pool et d'intégrer leurs pilotes au cours de l'installation.

Opsi prend en charge l'intégration automatique des pilotes dans l'installation, et simplifie donc le déploiement des pilotes.  Dans ce cas, les pilotes doivent simplement être placé dans le répertoire approprié.  Lorsque le script d'installation est appelé il cherche à travers ces répertoires et crée un catalogue. L'image de démarrage utilise automatiquement ce catalogue pour intégrer les bons pilotes.  Opsi prend en charge l'installation automatique des pilotes standard, USB, HD audio, et contrôleur de disque.

Pour qu'un pilote soit immédiatement installé avec Windows, vous devez placer les pilotes sur le serveur dans un format spécifique.  Les pilotes doivent être placés dans le répertoire des pilotes, avec le format '\*.inf' , où le nom du fichier décrit le pilote pour le programme d'installation de Windows. Les pilotes dans le format 'setup.exe' ou '*.zip' ne sont pas utilisés ici. Si vous avez un ordinateur qui a déjà installé les pilotes, alors vous pouvez extraire les pilotes appropriés à l'aide du programme 'double driver' (http://www.boozet.org/dd.htm).

Il y a plusieurs niveaux d'intégration des pilotes:  

* Packages de pilotes générales

* Pilotes préférés qui appartiennent à votre matériel, mais ne sont pas affectés à des ordinateurs spécifiques

* Les pilotes qui seront affectées manuellement à des ordinateurs

* Les pilotes qui seront automatiquement attribués aux ordinateurs utilisant les champs <vendeur> / <Modèle>

Ci-dessous, un exposé détaillé sur la façon d'inclure chacun de ces pilotes

[[opsi-getting-started-firststeps-osinstall-driverintegration-generaldrivers]]
==== Packages de pilotes génériques

Lorsque la configuration matérielle est très hétérogène, alors il peut être judicieux de travailler avec les packages de pilotes génériques. +
Les pilotes génériques peuvent être placés sous `./drivers/drivers`. +
Vous pouvez trouver par exemple les paquets de pilotes génériques ici http://driverpacks.net/ . +
Téléchargez le package du pilote approprié dans un répertoire temporaire, puis décompressez le package du pilote en utilisant le script opsi extract_driver_pack.py comme suit:
[source,prompt]
----
./extract_driver_pack.py <path to the temporary directory with the compressed driverpacks>
----
Cela vas décompresser et enregistrer les pilotes dans le répertoire `./drivers/drivers/`. +
Il peut arriver que les pilotes trouvés par opsi à cet endroit ne fonctionnent pas nécessairement avec votre matériel. +
Pour les pilotes qui se trouvent dans `./drivers/drivers/`, le pilote sera identifié à l'aide du matériel correspondant PCI IDs (par exemple USB- ou HD_Audio-ID) dans le fichier de description, puis intégré dans l'installation de Windows en fonction des besoins.

[[opsi-getting-started-firststeps-osinstall-driverintegration-preferred]]
==== Pilotes préférés

Dans le cas que vous avez à supporter du matériel spécial, et vous pouvez trouver les pilotes supplémentaires auprès des fabricants, utilisez la procédure suivante pour les inclure dans l'installation. +
Placez les pilotes supplémentaires dans leur propre répertoire sous: +
`./drivers/drivers/preferred`. +
(le nom et la profondeur de la structure du répertoire n'est pas important).  Les pilotes qui se trouvent dans le répertoire `./drivers/drivers/preferred` seront intégrés dans l'installation de Windows, en supposant que opsi trouve une correspondance convenable pour le matériel basé sur le PCI IDs (ex.. USB or HD_Audo-ID) dans le fichier de description. +
Des problèmes peuvent survenir lorsque le même PCI IDs des pilotes se trouve dans `preferred`. Dans ce cas, un mappage direct des pilotes des périphériques est nécessaire. 

[[opsi-getting-started-firststeps-osinstall-driverintegration-additional]]
==== Les pilotes qui seront attribuées manuellement aux ordinateurs

Lors de l'installation des pilotes supplémentaires sur la base du PCI-IDs ou USB-IDs, ils doivent être installés dans le répertoire `./drivers/drivers/additional` (le nom et la profondeur de la structure du répertoire n'est pas important).  Vous pouvez mapper un ou plusieurs pilotes pour le client à l'aide de la propriété du produit 'additional_drivers' et d'une liste de répertoires du pilote sous `./drivers/drivers/additional`.  Les répertoires spécifiés par 'additional_drivers' sont recherchés de façon récursive jusqu'à ce que tous les pilotes sont trouvés.  Cette méthode peut être utilisée pour créer un répertoire spécifique basé sur le type de client (ex. dell-optiplex-815).

Quand un pilote est trouvé dans le répertoire des pilotes qui est spécifié par 'additional_drivers' et correspond également à l'identifiant PCI, d'autres pilotes dans `drivers/preferred` ou `drivers/` ne seront pas utilisés.  Par conséquent les pilotes  dans 'additional_drivers' ajoutent des fonctionnalités qui n'auraient pas été trouvé avec les pilotes normaux.  En outre, les pilotes qui sont manuellement lié à un client à l'aide de 'additional_drivers' ont priorité sur les autres pilotes ('additional_drivers' peut être considéré comme 'super-preferred').

[[opsi-getting-started-firststeps-osinstall-driverintegration-byaudit]]
==== Les pilotes qui seront automatiquement attribués à des ordinateurs à l'aide des champs <vendeur> / <Modèle>

Les mécanismes décrits précédemment qui mappent directement les pilotes des périphériques est automatisé depuis la version 4.0.2 Release 2 de opsi.  Opsi recherchera dans le répertoire `./drivers/drivers/additional/byAudit` un nom de répertoire qui correspond au champ 'Vendor' qui a été donnée dans l'inventaire du matériel. Ce répertoire 'Vendor' recherchera un répertoire 'Model' qui correspond à ce qu'on voit dans l'inventaire matériel.   Si ce répertoire est trouvé, alors il sera attribué manuellement à la propriété du produit 'additional_drivers'. +
Le nom du répertoire 'byAudit' est sensible à la casse.  Les noms de répertoires pour 'Vendor' et 'Model' ne sont pas sensibles à la casse ('Dell' et 'dELL' sont traités de la même manière).

[[opsi-getting-started-firststeps-osinstall-driverintegration-structure]]
==== Structure du répertoire des pilotes et des fichiers des pilotes:

[source,configfile]
----
/opt/
  !-pcbin/
     !-install/
        !-winxppro/
           !-drivers
              |-classes/		(Liens vers des classes de pilotes de périphériques)
              |-hdaudioids/		(Liens vers des pilotes HD-Audio)
              |-pciids/			(Liens vers des pilotes PCI-ID)
              |-pci.ids			(base de données PCI)
              |-usbids/			(Liens vers des pilotes USB-ID)
              |-usb.ids			(base de données USB)
              |-vendors/		(Liens vers les pilotes du fabricant)
              !-drivers			(place pour les packages de pilotes génériques)
                 |-additional/		(pilotes assignées manuellement)
                    |-byAudit/		Pilotes spécifiques au modèle que 
                       |-<vendor>		seront affectés par 
                          |-<model>		l'inventaire du matériel
                 |-buildin/		(données pour la version i386)
                 |-preferred/		(pilotes certifiés)
                 |-exclude/		(pilotes exclus)
                 !-mydriverpacks/	(packages de pilotes d'exemple)
----

[[opsi-getting-started-firststeps-osinstall-driverintegration-processing]]
==== Traitement des différents niveaux d'intégration des pilotes 

La priorité est donnée aux pilotes qui sont trouvés en utilisant la propriété 'additional_drivers' ou à l'aide des données d'inventaire dans `./drivers/drivers/additional/byAudit`.  Les tests seront effectués lors de l'intégration du pilote pour déterminer quels pilotes sont déjà installés sur quelles périphériques matériels. Quand un pilote est introuvable pour un périphérique, la méthode suivante sera utilisée pour rechercher les pilotes.

Pour les appareils qui ont des pilotes qui n'ont pas été énumérés dans 'additional_drivers', opsi va rechercher, et intégrer, un pilote approprié basé sur le PCI ID (ex. USB-, HD_Audio-ID).  

'Intégration' des pilotes signifie ce qui suit:

* Le pilote sera copié sur le disque dur local dans `c:\drv\<num>`.

* L'installation de Windows recherche le sous-répertoire du pilote dans `c:\drv\` , où le nom du sous-répertoire sera lu à partir du fichier unattended à la racine du sous-répertoire 'unattend'.

[[opsi-getting-started-firststeps-osinstall-driverintegration-drivercheck]]
==== Ajout d'un Pilote et Vérification

Après tout changement dans le répertoire `./drivers/drivers` , appelez la commande suivante à partir du répertoire racine des produits Netboot afin de définir les permissions:
[source,prompt]
----
opsi-setup --set-rights ./drivers
----

Ensuite, appelez le script `./create_driver_links.py`.  Le script recherche à travers les sous-répertoires './drivers/drivers' et génère une liste de liens en utilisant le PCI-IDs, USB-IDs, HD-Audio-IDs qui permet au matériel de connaître les pilotes.  Le script va utiliser les pilotes dans les répertoires préférés.   

Le script `setup.py` examine le matériel des ordinateurs installés et identifie les pilotes nécessaires.  Ceux-ci seront copiés sur le disque et le fichier Unattended.txt sera corrigé.  Le script `create_driver_links.py` examine les produits NT5 une à la fois dans l'arbre 'i386' et extrait les fichiers. inf des pilotes nécessaires dans 'windows_builtin'.  Si vous apportez une modification à l'arborescence du répertoire i386 (ex. après l'installation d'un Service Pack), supprimez ce répertoire et lancez à nouveau `create_driver_links.py`.  Les pilotes reconnus pour les produits NT6, sont trouvés dans WinPE à 'windows_builtin'. 

Avec la commande suivante, on peut voir l'inventaire matériel pour un client:
[source,prompt]
----
./show_drivers.py <clientname>
----
Lorsque cette commande est appelée, il vous montrera une sélection des pilotes qui seront choisis pour l'installation Bootimage via PCI-IDs, USB-IDs, HD-Audio-IDs, et 'additional_drivers' (ou 'byAudit'),  et le matériel qui n'a toujours pas de pilote. 

Utilisez le résultat de `show_drivers.py` pour vérifier et voir quels pilotes doivent être installés.

Il se pourrait que les fabricants incluent des pilotes différents pour différents systèmes d'exploitation (ex. Vista ou Win7) ou différentes configurations (ex. SATA ou SATA RAID).  Le script `create_driver_links.py` ne peut pas faire cette distinction.  Si vous pensez que le mauvais pilote a été installé, déplacez le pilote dans le répertoire 'drivers/exclude' et appelez à nouveau `create_driver_links.py`.  Les pilotes dans le répertoire 'drivers/exclude' ne sont pas utilisés au cours de l'intégration.

Exemple de sortie d'un appel `show_drivers.py`:

[source,opsifiles]
----
./show_drivers.py pcdummy

PCI-Devices
   [(Standardsystemgeräte), PCI Standard-PCI-zu-PCI-Brücke]
      No driver - device directory  /opt/pcbin/install/winxppro/drivers/pciids/1022/9602 not found
   [ATI Technologies Inc., Rage Fury Pro (Microsoft Corporation)]
      Using build-in windows driver
   [(Standard-IDE-ATA/ATAPI-Controller), Standard-Zweikanal-PCI-IDE-Controller]
      /opt/pcbin/install/winxppro/drivers/drivers/D/M/N/123
   [Realtek Semiconductor Corp., Realtek RTL8168C(P)/8111C(P) PCI-E Gigabit Ethernet NIC]
      /opt/pcbin/install/winxppro/drivers/drivers/preferred/realtek_gigabit_net_8111_8168b
   [IEEE 1394 OHCI-konformer Hostcontroller-Hersteller, OHCI-konformer IEEE 1394-Hostcontroller]
      No driver - device directory '/opt/pcbin/install/winxppro/drivers/pciids/197B/2380' not found
   [Advanced Micro Devices, Inc., AMD AHCI Compatible RAID Controller]
      /opt/pcbin/install/winxppro/drivers/drivers/preferred/ati_raid_sb7xx
   [(Standard-USB-Hostcontroller), Standard OpenHCD USB-Hostcontroller]
      No driver - device directory '/opt/pcbin/install/winxppro/drivers/pciids/1002/4397' not found
   [ATI Technologies Inc, ATI SMBus]
      /opt/pcbin/install/winxppro/drivers/drivers/preferred/ati_smbus

USB-Devices
   [(Standard-USB-Hostcontroller), USB-Verbundgerät]
      /opt/pcbin/install/winxppro/drivers/drivers/preferred/brother_844x_pGerb
   [Microsoft, USB-Druckerunterstützung]
      /opt/pcbin/install/winxppro/drivers/drivers/preferred/brother_844x_pGerb

Additional drivers
   [ati_hdaudio_azalia]
     /opt/pcbin/install/winxppro/drivers/drivers/additional/ati_hdaudio_azalia
----

Exemple avec  'additional_drivers':
[source,opsifiles]
----
 ./show_drivers.py e5800
Manually selected drivers (additional)
   [hp_e5800]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64/HDXHPAI3.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64/HDX861A.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64/HDXHPAI1.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64/HDXCPC.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64/HDXHPAI2.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/autorun.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/ibxHDMI/IntcDAud.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/HDMI/IntcHdmi.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/Graphics/kit24890.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/IIPS/Impcd.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp54284/Realtek 64bit/hp64win7.inf]

PCI-Devices
   [8086:27C8]  Intel : Intel(R) N10/ICH7 Family USB Universal Host Controller - 27C8
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27DA]  Intel : Intel(R) N10/ICH7 Family SMBus Controller - 27DA
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27C9]  Intel : Intel(R) N10/ICH7 Family USB Universal Host Controller - 27C9
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27DF]  Intel : Intel(R) ICH7 Family Ultra ATA Storage Controllers - 27DF
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27CA]  Intel : Intel(R) N10/ICH7 Family USB Universal Host Controller - 27CA
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:2E30]  Intel : Intel(R) 4 Series Chipset Processor to I/O Controller - 2E30
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/not_preferred/x64/C/Intel/1
   [8086:27CB]  Intel : Intel(R) N10/ICH7 Family USB Universal Host Controller - 27CB
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:2E32]  Intel Corporation : Intel(R) G41 Express Chipset
      Manually selected [hp_e5800] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp50134/Graphics
   [8086:27CC]  Intel : Intel(R) N10/ICH7 Family USB2 Enhanced Host Controller - 27CC
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:244E]  Intel : Intel(R) 82801 PCI-Brücke - 244E
      Using build-in windows driver
      This driver will not be integrated, because same device already integrated in: '/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/not_preferred/x64/C/Intel/1/dmi_pci.inf'
   [8086:27D0]  Intel : Intel(R) N10/ICH7 Family PCI Express Root Port - 27D0
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27B8]  Intel : Intel(R) ICH7 Family LPC Interface Controller - 27B8
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27D2]  Intel : Intel(R) N10/ICH7 Family PCI Express Root Port - 27D2
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27C0]  Intel : Intel(R) N10/ICH7 Family Serial ATA Storage Controller - 27C0
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/R293337/WIN7
   [8086:27D8]  Microsoft : High Definition Audio-Controller
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/8086/27D8' not found
   [10EC:8136]  Realtek : Realtek RTL8102E/RTL8103E-Familie-PCI-E-Fast-Ethernet-NIC (NDIS 6.20)
      Manually selected [hp_e5800] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp54284/Realtek 64bit

USB-Devices
   [0461:0010]  (Standardsystemgeräte) : USB-Eingabegerät
      No driver - vendor directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/usbids/0461' not found
   [0461:4D20]  (Standardsystemgeräte) : USB-Eingabegerät
      No driver - vendor directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/usbids/0461' not found
   [058F:6366]  Kompatibles USB-Speichergerät : USB-Massenspeichergerät
      No driver - vendor directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/usbids/058F' not found
   [0461:0010]  (Standard-USB-Hostcontroller) : USB-Verbundgerät
      No driver - vendor directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/usbids/0461' not found

HD-Audio-Devices
   [10EC:0662]  Realtek High Definition Audio
      Manually selected [hp_e5800] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/hp_e5800/sp52852/Vista64
----

Exemple avec 'byAudit':
[source,opsifiles]
----
 ./show_drivers.py pctry5detlef
Manually selected drivers (additional)
   [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series Secondary (Microsoft Corporation - WDDM)/atiilhag.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series (Microsoft Corporation - WDDM)/atiilhag.inf]
      [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/MEDIA/Realtek AC'97 Audio/oem21.inf]

PCI-Devices
   [1002:5B70]  ATI Technologies Inc. : Radeon X300/X550/X1050 Series Secondary (Microsoft Corporation - WDDM)
      Manually selected [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series Secondary (Microsoft Corporation - WDDM)
      Multiple selected [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series (Microsoft Corporation - WDDM)
   [10DE:0053]  (Standard-IDE-ATA/ATAPI-Controller) : Standard-Zweikanal-PCI-IDE-Controller
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/0053' not found
   [10DE:005D]  (Standardsystemgeräte) : PCI Standard-PCI-zu-PCI-Brücke
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/005D' not found
   [1022:1100]  AMD : AMD HyperTransport(tm)-Konfiguration
      Using build-in windows driver
   [10DE:0054]  (Standard-IDE-ATA/ATAPI-Controller) : Standard-Zweikanal-PCI-IDE-Controller
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/evb_potsdam_fsc__esprimo_p625/FTS_NVIDIASATAAHCIDRIVERVISTA64V103042MCP78__1026963/NVIDIA_SATA_AHCI_DRIVER_Vista64_V10.3.0.42_MCP78 (textmode capable)
   [1022:1101]  AMD : AMD-Adresszuordnungskonfiguration
      Using build-in windows driver
   [10DE:0055]  (Standard-IDE-ATA/ATAPI-Controller) : Standard-Zweikanal-PCI-IDE-Controller
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/evb_potsdam_fsc__esprimo_p625/FTS_NVIDIASATAAHCIDRIVERVISTA64V103042MCP78__1026963/NVIDIA_SATA_AHCI_DRIVER_Vista64_V10.3.0.42_MCP78 (textmode capable)
   [1022:1102]  AMD : AMD DRAM und HyperTransport(tm)-Nachverfolgungsmoduskonfiguration
      Using build-in windows driver
   [10DE:0057]  NVIDIA : NVIDIA nForce-Netzwerkcontroller
      Using build-in windows driver
   [1022:1103]  AMD : Sonstige AMD-Konfiguration
      Using build-in windows driver
   [10DE:0059]  Realtek : Realtek AC'97 Audio
      Manually selected [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/MEDIA/Realtek AC'97 Audio
   [10DE:005E]  NVIDIA : NVIDIA nForce4 HyperTransport-Brücke
      /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/preferred/ga-ma78-pcbon4/chipset_win7-64/SMBUS
   [104C:8025]  Texas Instruments : OHCI-konformer Texas Instruments 1394-Hostcontroller
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/104C/8025' not found
   [10DE:005A]  (Standard-USB-Hostcontroller) : Standard OpenHCD USB-Hostcontroller
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/005A' not found
   [10DE:0050]  (Standardsystemgeräte) : PCI Standard-ISA-Brücke
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/0050' not found
   [10DE:005B]  (Standard-USB-Hostcontroller) : Standard PCI-zu-USB erweiterter Hostcontroller
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/005B' not found
   [1002:5B60]  ATI Technologies Inc. : Radeon X300/X550/X1050 Series (Microsoft Corporation - WDDM)
      Manually selected [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series Secondary (Microsoft Corporation - WDDM)
      Multiple selected [/opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi] /opt/pcbin/install/win7-x64-professional-msdn/drivers/drivers/additional/byAudit/nvidia/awrdacpi/pctry5detlef/Display/Radeon X300-X550-X1050 Series (Microsoft Corporation - WDDM)
   [10DE:0052]  NVIDIA : NVIDIA nForce PCI-Systemverwaltung
      Using build-in windows driver
   [10DE:005C]  (Standardsystemgeräte) : PCI Standard-PCI-zu-PCI-Brücke
      No driver - device directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/pciids/10DE/005C' not found

USB-Devices
   [1241:1111]  (Standardsystemgeräte) : USB-Eingabegerät
      No driver - vendor directory '/opt/pcbin/install/win7-x64-professional-msdn/drivers/usbids/1241' not found

HD-Audio-Devices
   No devices installed
----

TIPS::
* Les noms de répertoires `NDIS1` sont pilotes Vista ; `NDIS2` sont pilotes Win7

* Certains pilote de puces contiennent des fichiers de description, sans pour autant fournir des pilotes.  Un exemple serait 'cougar.inf' de Intel. Si un tel 'Pseudo-Driver' était placé dans `additional_drivers` (ou 'byAudit'), les autres pilotes peuvent être exclus.  Il est préférable de déplacer ces répertoires au sous répertoire 'preferred'.     

* Les pilotes SATA et SATA-RAID se référer au même PCI ID.  Le pilote SATA-RAID ne peut pas fonctionner avec un système à disque unique.

* Vérifiez la sortie de `./show_drivers` attentivement !

include::../common/opsi_manual_inventory.asciidoc[]

[[opsi-release-notes-402-opsi-linux-bootimage-dhclient]]
== Les modifications apportées au nouveau opsi-linux-bootimage

'{opsi-linux-bootimage}' (version 20120728-1) fonctionne en interne avec `dhclient` au lieu de `pump` pour la demande initiale dhcp. 

Le programme 'pump' a été utilisé dans la version précédente parce que 'dhclient' ne traite pas le drapeau 'next-server'.  Ce drapeau a été utilisé par opsi pour définir l'adresse du opsiserver.  Il n'est pas possible de configurer le programme 'pump', et il donne un "hardreset" sur la carte réseau pour actualiser l'adresse ip du client.  Cela provoque de nombreux problèmes dans différentes infrastructures de réseau.  Pour cette raison, nous avons décidé d'utiliser 'dhclient' au lieu de 'pump'.

Cette modification provoque le problème que `opsi-clientbootcd` demande le '{opsi-server}' même si vous choisissez "avec DHCP" sur le menu démarrer.

[[opsi-release-notes-402-opsiconfd-all]]
== Les modifications apportées à opsiconfd

Le service web opsi sera construit comme "noarch". Pour certaines distributions basées rpm il a été construit pour une architecture spécifque. Mais ce n'est plus nécessaire, parce qu'il n'y a pas de binaires dans ce package.

Cela pourrait produire des problèmes pour certaines distributions lorsque vous essayez de mettre à jour ces paquets.  Si vous obtenez une erreur comme:  "`opsiconfd-4.0.2.3-1.1.i386.rpm` couldn't be found" , alors vous devez réinstaller le paquet '{opsiconfd}' manuellement à partir du repository.

Les scripts d'initialisation ont été modifiés ainsi. Le niveaux d'exécution 4 ne sera pas utilisé sur des distributions basées rpm.

[[opsi-release-notes-402-opsi-pam-authentification]]
== Authentification opsi PAM

opsi utilise certains modules `PAM` pour authentifier l'utilisateur. Avec cette nouvelle version, opsi utilise différents modules pour certaines distributions. La liste suivante vous donnera un bref aperçu sur les modules qui sont utilisés:

Par défaut:: common-auth +
SLES:: sshd +
CentOS et RedHat:: system-auth +
RedHat 6:: password-auth

Vous pouvez voir dans la liste ci-dessus, lequel différentes modules `PAM` sont utilisés.  Cependant, il pourrait être le cas que un autre module `PAM` est nécessaire, en fonction de la configuration locale.  Le code source peut être modifié pour tenir compte de ces modifications. Pour plus de souplesse, sans changer le code source, il est possible avec cette version de créer un fichier nommé: `opsi-auth` dans le répertoire `/etc/pam.d/`. Si ce fichier existe, opsi va utiliser cette configuration automatiquement au lieu de les modules listés ci-dessus.

L'exemple suivant vous montrera la nouvelle fonctionnalité: Si vous exécutez un système debian/ubuntu et vous obtenez un erreur d'authentification `PAM`, même si vous pouvez vous connecter avec les mêmes informations d'identification via ssh sur le serveur, alors vous pouvez créer le fichier: `/etc/pam.d/opsi-auth` avec le contenu suivant:

[source,configfile]
----
@include sshd
----

Après le redémarrage de opsiconfd, opsi utilisera automatiquement le module `sshd`-`PAM` pour l'authentification des utilisateurs.

[[opsi-manual-important-files-etc-opsi-opsiconf]]
== /etc/opsi/opsi.conf

depuis la version 4.0.2-2

Configurations générales opsi.

Exemple:
[source,configfile]
----
[groups]
fileadmingroup = pcpatch
----
Contexte:
L'installation classique avec l'utilisateur:  'pcpatch' avec le groupe principal: 'pcpatch' ne fonctionne pas 
avec Samba 4.  Samba 4 a des restrictions fondamentales sur Active-Directory, de sorte que les groupes 
avec le même nom que l'utilisateur (comme c'est courant dans Unix/Linux) ne sont plus autorisés. Pour cette raison, 
un nouveau fichier de configuration a été mis en place:  `/etc/opsi/opsi.conf`, qui permettra de contrôler la façon dont les groupes 
auront accès à Samba-Access.  Par exemple, UCS 3 va utiliser ce fichier pour renommer le 
groupe 'pcpatch' vers `opsifileadmins`.  Cela signifie que l'utilisateur qui appartient au groupe 'pcpatch' 
sous UCS 3, doit maintenant appartenir au groupe 'opsifileadmins'.  Cette particularité est seulement pour UCS 3 
et n'est pas le même pour d'autres distributions (pour autant qu'ils utilisent Samba 4, ou ont installé Samba 4).

[[opsi-getting-started-softwintegration-tutorial-find-switches]]
== Trouver des Switches Silent ou Unattended

Dans le mode „Unattended" ou „silent", les arguments de ligne de commande sont appelées pendant l'installation non-interactive, et ces arguments de ligne de commande peuvent être trouvés dans le programme d'installation d'origine. 

Le problème est alors de trouver les arguments appropriés de ligne de commande du programme d'installation d'origine.

.Identifier le fabricant du programme d'installation:
La plupart des programmes d'installation sont construits en utilisant 'Inno', 'NSIS', 'Installshield' ou 'Wise'.   Chacun de ces frameworks possède son propre interrupteur.  Les méthode suivante peut être utilisée pour déterminer le framework et les autres informations nécessaires:  Les chaînes d'entrée peut être déterminée en utilisant le programme de ligne de commande 'strings' étant donné le programme d'installation 'setup.exe', et le nom du framework peut être trouvé en utilisant 'grep' ou 'findstr'.

La même méthode est utilisée dans `opsi-setup-detector`.  Voir l'exemple ci-dessous: 

.opsi setup detector
image::../images/opsi-setup-detector.png[scaledwidth="50%"]

Ce programme GUI peut être appelé depuis le menu contextuel de Windows Explorer.  

.opsi setup detector in Windows Explore context menu
image::../images/opsi-setup-detector-context-small-en.png[scaledwidth="50%"]

'opsi setup detector' fait partie du paquet 'opsi-adminutils'.  Le programme peut être téléchargé comme une application autonome à partir de:

http://download.uib.de/opsi4.0/helper/opsisetupdetector.exe

[[opsi-winst-cookbook-local-admin]]
=== Script pour les installations dans le contexte d'un administrateur local

Le produit `opsi-template-with-admin` a été complètement révisé:

* Le programme externe psgetsid.exe est désormais plus nécessaire.
* Dans le script maître, il y a seulement trois variables à modifier qui sont indiquées avec `Please edit the following values`.
* Le script local dispose désormais d'un accès complet au serveur opsi. Cela signifie que des fonctions telles que `GetProductProperty` ou `OpsiServiceCall` ou l'accès à la gestion des licences fonctionnent comme d'habitude.
* Également la fonction `isFatalError` fonctionne désormais comment vous vous y attendez.
* Le verrouillage du clavier et de la souris et du LogLevel sont désormais contrôlé par une propriété du produit.
* Le produit nécessite opsi-winst >= 4.11.3.3

[[opsi-winst]]
== opsi-winst 4.11.3

[[opsi-winst-cliparams]]
=== Début et Options de ligne de commande

Depuis la version 4.11.3, le programme '{opsi-winst}' contient un manifeste avec la déclaration: +
`<requestedExecutionLevel level="highestAvailable" />`. Cela signifie que si '{opsi-winst}' est appelée sur un OS NT6 par un administrateur, il fonctionnera comme un processus 'élevé'. Si '{opsi-winst}' est appelée avec des privilèges d'utilisateur normaux, il sera exécuté avec les privilèges de cet utilisateur.

[[opsi-winst-global-const]]
=== Constantes globales de texte


[[opsi-winst-global-const-list-winst]]
==== '{opsi-winst}' Chemin et Répertoire

`%opsiScriptHelperPath%` +
Correspond à: `%ProgramFiles32Dir%\opsi.org\opsiScriptHelper` +
Chemin dans lequel le programme d'aide, les bibliothèques, et les éléments nécessaires à l'exécution du script peuvent être installés. +
Depuis 4.11.3.2

[[opsi-winst-primary-sections]]
=== Sections primaires

[[opsi-winst-params-errors]]
==== Réaction aux erreurs

*  `FatalOnSyntaxError =` <valeur booléenne> +
** 'true' = (par défaut) Si une erreur de syntaxe se produit, l'exécution du script sera interrompu et le résultat du script sera mis à 'failed'. En outre, le message 'Syntax Error' sera transmis au serveur opsi.
** 'false' = Si une erreur de syntaxe se produit, l'exécution du script +ne+ sera +pas+ interrompu et le résultat du script sera mis à 'success'.

Dans les deux cas ci-dessus, l'erreur de syntaxe sera enregistré comme 'Critical'. +
Dans les deux cas ci-dessus, le compteur d'erreurs sera augmenté de 1. +
Depuis 4.11.3.2 +
Dans les anciennes versions il n'y avait pas la journalisation des erreurs de syntaxe, aucune augmentation de compteur d'erreur, et le résultat était toujours mis à 'success'.

[[opsi-winst-params-showmode]]
==== Afficher le mode fenêtre
Pour changer les modes de la façon dont la fenêtre de '{opsi-winst}' est affiché, utilisez ces commandes:


* `NormalizeWinst` +
configure la fenêtre de '{opsi-winst}' au mode 'normal'

* `IconizeWinst` +
configure la fenêtre de '{opsi-winst}' au mode 'minimisés'

* `RestoreWinst` +
configure la fenêtre de '{opsi-winst}' au mode 'maximisée'

[[opsi-winst-commands-include]]
==== Les commandes Include

CAUTION: L'utilisation des commandes 'include' peut conduire à la confusion du code. +
Utilisez avec prudence si vous êtes un débutant.

[[opsi-winst-commands-include-syntax]]
===== Les commandes Include: Syntaxe

Les commandes `include_*` peuvent être utilisés pour ajouter des fichiers de script externes au script en cours d'exécution pendant l'exécution. La commande `include_*` peut inclure des fichiers de script externes, soit en insert (après la ligne en cours) ou comme un ajout (après la dernière ligne). Les commandes 'include' peuvent être utilisés n'importe où dans une section primaire. Les fichiers de script externes peuvent contenir leurs propres commandes include. +
Les commandes include sont disponibles depuis la version 4.11.3

* `include_insert` <nom du fichier> +
insère <nom du fichier> après la ligne courante dans le script en cours d'exécution. Ainsi, la première ligne du fichier inclus est la ligne suivante qui sera exécutée par '{opsi-winst}'.

* `include_append` <nom du fichier> +
ajoute le contenu de <nom du fichier> à l'exécution du script. Ce type d'insertion est normalement utilisée pour inclure des sections d'une bibliothèque.

Dans les deux cas <nom du fichier> est: +

* Un chemin d'accès complet à un fichier existant.

* Un fichier existant dans `%ScriptPath%`

* Un fichier dans `%opsiScriptHelperPath%\lib` +
Est équivalent à: '%ProgramFiles32Dir%\opsi.org\opsiScriptHelper\lib'

* Un fichier existant dans `%WinstDir%\lib`

Les tests pour l'emplacement de <nom du fichier> sont effectuées dans l'ordre ci-dessus. '{opsi-winst}' utilise le premier fichier qu'il trouve qui a un nom correspondant.

Exemple: +
Quand nous exécutons un script qui contient les commandes suivantes:
[source,winst]
----
[Actions]
include_append "section_Files_del_tmp_dummy.opsiinc"
include_insert "include-test1.opsiinc"
----

Le fichier `include-test1.opsiinc` est exécuté en premier.  Le contenu du fichier inclus `include-test1.opsiinc` est:
[source,winst]
----
DefVar $inctestvar$
set $inctestvar$ = "inctest"
Files_del_tmp_dummy
include_append "section_Files_copy_inctest.opsiinc"
Files_copy_inctest

if fileExists("c:\opsi.org\tmp\dummy.txt") 
	comment "passed"
else
	comment "failed"
	set $TestResult$ = "not o.k."
	LogWarning "include test failed"
endif

if fileExists("%scriptpath%\test-files\dummy.txt") 
	comment "passed"
else
	comment "failed"
	set $TestResult$ = "not o.k."
	LogWarning "include test failed"
endif
Files_del_tmp_dummy
----

Le contenu du fichier inclus  `section_Files_copy_inctest.opsiinc` est:
[source,winst]
----
[Files_copy_inctest]
copy "%scriptpath%\test-files\dummy.txt" "c:\opsi.org\tmp"
----

Depuis, l'appel à Files_del_tmp_dummy se passe dans `include-test1.opsiinc` sans que `section_Files_del_tmp_dummy.opsiinc` soit référencé à l'intérieur de `include-test1.opsiinc`, nous devons appeler include_append "section_Files_del_tmp_dummy.opsiinc" au tout début de notre script. Autrement, opsi-winst relèvera que Files_del_tmp_dummy n'est pas définie. +
Le contenu du fichier inclus  `section_Files_del_tmp_dummy.opsiinc` est:
[source,winst]
----
[Files_del_tmp_dummy]
del -f "c:\opsi.org\tmp\dummyt.txt"
----

[[opsi-winst-commands-include-library]]
===== Les commandes Include: Library

Les suivants fichiers include sont livrés avec la version 4.11.3, et sont situés dans `%WinstDir%\lib`:

`insert_check_exit_code.opsiinc`:
[source,winst]
----
; opsi include file

DefVar $ExitCode$

include_append "section_sub_check_exitcode.opsiinc"
----

`insert_get_licensekey.opsiinc`:
[source,winst]
----
; opsi include file

DefVar $LicenseRequired$
DefVar $LicenseKey$
DefVar $LicensePool$

include_append "section_sub_get_licensekey.opsiinc"
----

`section_sub_check_exit_code.opsiinc`:
[source,winst]
----
;opsi include file

[Sub_check_exitcode]
comment "Test for installation success via exit code"
set $ExitCode$ = getLastExitCode
; informations to exit codes see
; http://msdn.microsoft.com/en-us/library/aa372835(VS.85).aspx
; http://msdn.microsoft.com/en-us/library/aa368542.aspx
if ($ExitCode$ = "0")
	comment "Looks good: setup program gives exitcode zero"
else
	comment "Setup program gives a exitcode unequal zero: " + $ExitCode$
	if ($ExitCode$ = "1605")
		comment "ERROR_UNKNOWN_PRODUCT	1605	This action is only valid for products that are currently installed."
		comment "Uninstall of a not installed product failed - no problem"
	else
		if ($ExitCode$ = "1641")
			comment "looks good: setup program gives exitcode 1641"
			comment "ERROR_SUCCESS_REBOOT_INITIATED	1641	The installer has initiated a restart. This message is indicative of a success."
			ExitWindows /Reboot
		else
			if ($ExitCode$ = "3010")
				comment "looks good: setup program gives exitcode 3010"
				comment "ERROR_SUCCESS_REBOOT_REQUIRED	3010	A restart is required to complete the install. This message is indicative of a success."
				ExitWindows /Reboot
			else
				logError "Fatal: Setup program gives an unknown exitcode unequal zero: " + $ExitCode$
				isFatalError "Exit Code: "+ $ExitCode$
			endif
		endif
	endif
endif
----

`section_sub_get_licensekey.opsiinc`:
[source,winst]
----
; opsi include file

[Sub_get_licensekey]
if opsiLicenseManagementEnabled
	comment "License management is enabled and will be used"

	comment "Trying to get a license key"
	Set $LicenseKey$ = demandLicenseKey ($LicensePool$)
	; If there is an assignment of exactly one license pool to the product the following call is possible:
	; Set $LicenseKey$ = demandLicenseKey ("", $ProductId$)
	;
	; If there is an assignment of a license pool to a windows software id, it is possible to use:
	; DefVar $WindowsSoftwareId$
	; $WindowsSoftwareId$ = "..."
	; Set $LicenseKey$ = demandLicenseKey ("", "", $WindowsSoftwareId$)
	
	DefVar $ServiceErrorClass$
	set $ServiceErrorClass$ = getLastServiceErrorClass
	comment "Error class: " + $ServiceErrorClass$
	
	if $ServiceErrorClass$ = "None"
		comment "Everything fine, we got the license key '" + $LicenseKey$ + "'"
	else
		if $ServiceErrorClass$ = "LicenseConfigurationError"
			LogError "Fatal: license configuration must be corrected"
			LogError getLastServiceErrorMessage
			isFatalError $ServiceErrorClass$
		else 
			if $ServiceErrorClass$ = "LicenseMissingError"
				LogError "Fatal: required license is not supplied"
				isFatalError $ServiceErrorClass$
			endif
		endif
	endif
else
	LogError "Fatal: license required, but license management not enabled"
	isFatalError "No Licensemanagement"
endif
----

[[opsi-winst-string-functions-handling]]
==== Manipulation de chaîne

* `contains(`<chaîne>, <sous-chaîne>`)` +
Une fonction booléenne qui retourne 'true' si <chaîne> contient <sous-chaîne>. Cette fonction est sensible à la casse. +
Disponible depuis 4.11.3 +
Exemple:
[source,winst]
----
set $ConstTest$ = "1xy451Xy451XY45"
set $CompValue$ ="xy"
if contains($ConstTest$, $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $CompValue$ ="xY"
if not(contains($ConstTest$, $CompValue$))
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

* `stringReplace(`<chaîne>, <ancien motif>, <nouveau motif>`)` +
retourne une chaîne, qui présente toutes les occurrences de <ancien motif> remplacées par <nouveau motif> de la chaîne d'entrée <chaîne>. +
Disponible depuis 4.11.3 +
Exemple:
[source,winst]
----
set $ConstTest$ = "123451234512345"
set $CompValue$ = stringReplace("1xy451Xy451XY45","xy","23")
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

* `strLength(`<chaîne>`)` +
Retourne le nombre de caractères dans <chaîne> +
Disponible depuis 4.11.3 +
Exemple:
[source,winst]
----
set $tmp$ = "123456789"
set $ConstTest$ = "9"
set $CompValue$ = strLength($tmp$)
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $tmp$ = ""
set $ConstTest$ = "0"
set $CompValue$ = strLength($tmp$)
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

* `strPos(`<chaîne>, <sous-chaîne>`)` +
retourne la position de la première <sous-chaîne> dans <chaîne>. Si <sous-chaîne> n'est pas trouvé, alors "0" est la valeur de retour. La fonction est sensible à la casse. +
Disponible depuis 4.11.3 +
Exemple:
[source,winst]
----
set $tmp$ = "1xY451Xy451xy45"
set $ConstTest$ = "7"
set $CompValue$ = strPos($tmp$,"Xy")
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $tmp$ = lower("1xY451Xy451xy45")
set $ConstTest$ = "2"
set $CompValue$ = strPos($tmp$,lower("xy"))
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

* `strPart(`<chaîne>, <la position de départ>, <nombre de caractères>`)` +
retourne la partie de <chaîne> commençant par <la position de départ> et inclue les suivants <nombre de caractères>. Si il y a moins de <nombre de caractères> après <la position de départ>, la chaîne retournée sera le reste des caractères après <la position de départ>. +
Le comptage des caractères commence par 1. +
Disponible depuis 4.11.3 +
Exemple:
[source,winst]
----
set $tmp$ = "123456789"
set $ConstTest$ = "34"
set $CompValue$ = strPart($tmp$,"3","2")
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $tmp$ = "123456789"
set $ConstTest$ = "56789"
set $CompValue$ = strPart($tmp$, strPos($tmp$,"56"),strLength($tmp$))
if $ConstTest$ = $CompValue$
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

* `unquote(`<chaîne>,<chaîne quote>`)`  +
retourne la version sans guillemets de la <chaîne>, si <chaîne> est cité avec <chaîne quote> +
Un seul caractère (le premier caractère) de <chaîne quote> est acceptée comme un délimiteur. Les espaces en début sont ignorés. +
Disponible depuis 4.11.2.1
[source,winst]
----
set $ConstTest$ = "b"
set $CompValue$ = unquote("'b'", "'")
comment "compare values"
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
comment "double quote"
set $ConstTest$ = "b"
set $CompValue$ = unquote('"b"', '"')
comment "compare values"
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
comment "quote string will be trimmed and then only the first char is used"
comment "note: brackets are different chars"
set $ConstTest$ = "b]"
set $CompValue$ = unquote("[b]", " [{ ")
comment "compare values"
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
comment "not usable to remove brackets"
set $ConstTest$ = "b]"
set $CompValue$ = unquote("[b]", "[")
set $CompValue$ = unquote($CompValue$,"]")
set $CompValue$ = unquote("[b]", "]")
set $CompValue$ = unquote($CompValue$,"[")
set $CompValue$ = unquote(unquote("[b]", "["),"]")
comment "compare values"
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
comment "if string not quoted it will be come back without changes"
set $ConstTest$ = "b"
set $CompValue$ = unquote("b", "'")
comment "compare values"
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----


[[opsi-winst-string-functions-others]]
==== Autres Fonctions sur les chaînes

*  `getDiffTimeSec` +
retourne une chaîne avec le nombre entier de secondes écoulées depuis le dernier appel de `marktime`. +
Disponible depuis 4.11.3.1

* `SidToName(`<sid connu>`)` +
retourne une chaîne avec le nom localisé du groupe avec le <sid connu>. Par exemple, si <sid connu> est égal à 'S-1-5-32-544' alors `SidToName` retourne 'Administrators'.  +
Disponible depuis 4.11.3.1

* `GetMyIpByTarget(`<adresse ip cible>`)` +
retourne une liste des adresses IP, qui tentent de rejoindre le système d'exploitation à <adresse ip cible>. Cette fonction retourne une valeur qui est plus sûr que la constante `%IPAddress%`. +
Disponible depuis 4.11.3.1 +
Example:
[source,winst]
----
set $CompValue$ = getMyIpByTarget("%opsiServer%")
----

* `GetIpByName(`<ip addr / ip name>`)` +
renvoie les adresses IP des ordinateurs avec le <ip addr / ip name> +
Disponible depuis 4.11.3.2
[source,winst]
----
set $ConstTest$ = "%IPAddress%"
set $string1$ = "%IPAddress%"
set $CompValue$ = getIpByName($string1$)
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $CompValue$ = getIpByName("%HostID%")
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
set $CompValue$ = getIpByName("%PCName%")
if ($ConstTest$ = $CompValue$)
	comment "passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "failed"
endif
----

*  `getLastExitCode` +
renvoie une chaîne qui contient les valeur du code de sortie du dernier processus appelé par une section WinBatch / DosBatch / ExecWith. +
Lorsque vous utilisez une section DosBatch ou ExecWith, vous obtiendrez normalement le code de sortie de l'interprète qui a été appelé. Pour obtenir le code de sortie du script, vous devez le définir explicitement.

Exemple:
[source,winst]
----
DosInAnIcon_exit1
set $ConstTest$ = "1"
set $CompValue$ = getLastExitCode
if ($ConstTest$ = $CompValue$)
	comment "DosBatch / DosInAnIcon  exitcode passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "DosBatch / DosInAnIcon  exitcode failed"
endif

[DosInAnIcon_exit1]
rem create an errolevel= 1
VERIFY OTHER 2> NUL
echo %ERRORLEVEL%
exit %ERRORLEVEL%
----


[[opsi-winst-commands-if-else-bool-functions]]
==== Les expressions booléennes


* `runningAsAdmin` +
retourne 'true' si le script en cours d'exécution a été exécuté avec des privilèges d'administrateur. +
Disponible depuis 4.11.1.1

* `isLoginScript` +
retourne 'true' si le script en cours d'exécution a été appelé comme 'userLoginScript' utilisant l'extension opsi 'User Profile Management'. +
Disponible depuis 4.11.2.1

* `contains(`<chaîne>, <sous-chaîne>`)` +
Fonction booléenne qui retourne 'true' si <chaîne> contient <sous-chaîne>. Cette fonction est sensible à la casse. +
Disponible depuis 4.11.3 

* `isNumber(`<chaîne>`)` +
Fonction booléenne qui retourne 'true' si <chaîne> représente un nombre entier. +
Disponible depuis 4.11.3

[[opsi-winst-stringlist-create-by-registry]]
==== Les listes de chaînes du Registre


* `getRegistryKeyList32(`<clé de registre>`)` +
Retourne une liste de chaînes avec les noms de toutes les clés à l'intérieur de <clé de registre>. +
32 Bit mode (avec redirection). Disponible depuis 4.11.3

* `getRegistryKeyList64(`<clé de registre>`)` +
Retourne une liste de chaînes avec les noms de toutes les clés à l'intérieur de <clé de registre>. +
64 Bit mode (sans redirection). Disponible depuis 4.11.3

* `getRegistryKeyListSysnative(`<clé de registre>`)` +
Retourne une liste de chaînes avec les noms de toutes les clés à l'intérieur de <clé de registre>. +
Mode (redirection) dépend de l'architecture du système d'exploitation. Disponible depuis 4.11.3

* `getRegistryVarList32(`<clé de registre>`)` +
Retourne une liste de chaînes avec le noms de toutes les entrées de valeur associée à la clé <clé de registre>. +
32 Bit mode (avec redirection). Disponible depuis 4.11.3

* `getRegistryVarList64(`<clé de registre>`)` +
Retourne une liste de chaînes avec le noms de toutes les entrées de valeur associée à la clé <clé de registre>. +
64 Bit mode (sans redirection). Disponible depuis 4.11.3

* `getRegistryVarListSysnative(`<clé de registre>`)` +
Retourne une liste de chaînes avec le noms de toutes les entrées de valeur associée à la clé <clé de registre>. +
Mode (redirection) dépend de l'architecture du système d'exploitation. Disponible depuis 4.11.3

* `getRegistryVarMap32(`<clé de registre>`)` +
Fournit une carte de toutes les paires nom=valeur dans la clé de registre donnée <clé de registre>. +
32 Bit Mode (avec redirection). Disponible depuis 4.11.3

* `getRegistryVarMap64(`<clé de registre>`)` +
Fournit une carte de toutes les paires nom=valeur dans la clé de registre donnée <clé de registre>. +
64 Bit Mode (avec redirection). Disponible depuis 4.11.3

* `getRegistryVarMapSysnative(`<clé de registre>`)` +
Fournit une carte de toutes les paires nom=valeur dans la clé de registre donnée <clé de registre>. +
Mode (redirection) dépend de l'architecture du système d'exploitation. Disponible depuis 4.11.3

Exemple: +
Dans un premier temps, nous avons créer des entrées dans la base de registre avec l'exemple de code suivant: +
[source,winst]
----
Registry_createkeys /32Bit

[Registry_createkeys]
openkey [HKEY_LOCAL_MACHINE\SOFTWARE\opsi.org\opsi-winst-test]
set "var1" = "value1"
set "var2" = REG_SZ:"value2"
set "var3" = REG_EXPAND_SZ:"value3"
set "var4" = REG_DWORD:444
set "var5" = REG_BINARY:05 05 05 0F 10
set "var6" = REG_MULTI_SZ:"value6|value7|de"
openkey [HKEY_LOCAL_MACHINE\SOFTWARE\opsi.org\opsi-winst-test\key1]
openkey [HKEY_LOCAL_MACHINE\SOFTWARE\opsi.org\opsi-winst-test\key2]
openkey [HKEY_LOCAL_MACHINE\SOFTWARE\opsi.org\opsi-winst-test\key3]
openkey [HKEY_LOCAL_MACHINE\SOFTWARE\opsi.org\opsi-winst-test\key4]
----
Compte tenu des entrées de registre dans l'exemple ci-dessus, et le code ci-dessous:
[source,winst]
----
set $list$ = getRegistryVarList32("hklm\software\opsi.org\opsi-winst-test")
----
nous verrons les valeurs suivantes dans le journal: 
----
Set  $list$ = GetRegistryVarList32("hklm\software\opsi.org\opsi-winst-test")
Registry started with redirection (32 Bit)
    retrieving strings from GetRegistryVarList32 [switch to loglevel 7 for debugging]
        (string   0)var1
        (string   1)var2
        (string   2)var3
        (string   3)var4
        (string   4)var5
        (string   5)var6
----

Ensuite, nous appelons:
[source,winst]
----
set $list$ = getRegistryVarMap32("hklm\software\opsi.org\opsi-winst-test")
----
Le journal suivant: 
----
Set  $list$ = GetRegistryVarMap32("hklm\software\opsi.org\opsi-winst-test")
retrieving strings from GetRegistryVarMap32 [switch to loglevel 7 for debugging]
    (string   0)var1=value1
    (string   1)var2=value2
    (string   2)var3=value3
    (string   3)var4=444
    (string   4)var5=05 05 05 0F 10
    (string   5)var6=value6
----

Compte tenu des entrées de registre dans l'exemple ci-dessus, et le code ci-dessous:
[source,winst]
----
set $list$ = getRegistryKeyList32("hklm\software\opsi.org\opsi-winst-test")
----
nous aurons les clés suivantes dans le journal:
----
Set  $list$ = GetRegistryKeyList32("hklm\software\opsi.org\opsi-winst-test")
Registry started with redirection (32 Bit)
    retrieving strings from GetRegistryKeyList32 [switch to loglevel 7 for debugging]
        (string   1)key1
        (string   2)key2
        (string   3)key3
        (string   4)key4
----

[[opsi-winst-stringlist-create-by-property]]
==== Les listes de chaînes provenant des Propriétés du produit

* `getProductPropertyList(`<nom de la propriété>,<valeur par défaut>`)` +
retourne une liste de chaînes de valeurs qui sont désignés par la propriété des produits à valeurs multiples <nom de la propriété>. S'il n'y a pas de connexion au serveur opsi, la liste de chaînes qui en résulte contient uniquement <valeur par défaut>. +
Si vous appelez la fonction `GetProductProperty` avec une propriété à valeurs multiples, vous obtiendrez les valeurs sélectionnées dans un format de chaîne séparée par des virgules. Cela conduira à des problèmes si les valeurs retournées contiennent des caractères séparés par des virgules qui ne sont pas destinés à être analysés. +
Disponible depuis 4.11.3 +
Example:
[source,winst]
----
;Property "dummymulti" has the values: ("ab", "cd", "ef", "g,h")
set $list$ = GetProductPropertyList ("dummymulti","True")
if not ("" = takeFirstStringContaining($list$,"g,h"))
	comment "GetProductPropertyList passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "GetProductPropertyList failed"
endif

set $ConstTest$ = "ab,cd,ef,g,h"
set $CompValue$ = GetProductProperty ("dummymulti","True")
if ($ConstTest$ = $CompValue$)
	comment "GetProductProperty passed"
else
	set $TestResult$ = "not o.k."
	LogWarning "GetProductProperty failed"
endif
----

[[opsi-winst-stringlist-misc]]
==== Autres Listes de chaînes

* `getProfilesDirList` +
Fournit une liste de chemins d'accès aux profils locaux. +
Les profils qui contiennent les mots suivants *ne* seront *pas* considérés: +

** 'localservice'

** 'networkservice'

** 'systemprofile'

Le profil de l''utilisateurs par défaut' est inclus dans le liste. +
`All User` ou `Public` ne sont pas inclus dans le liste.

Exemple:
[source,winst]
----
set $list1$ = getProfilesDirList
----
en résulte le journal suivant:
----
Set  $list1$ = getProfilesDirList
Registry started with redirection (32 Bit)
    retrieving strings from getProfilesDirList [switch to loglevel 7 for debugging]
        (string   0)C:\Users\Administrator
        (string   1)C:\Users\Default
----




[[opsi-winst-commands-isfatalerror]]
==== Garder une trace des installations qui ont échoué

Si une installation de produit échoue, cela devrait être signalé au serveur.

En raison du fait qu'il n'existe pas de méthode automatique qui détecte un échec de l'installation, le test pour une installation qui a échoué doit être fait à l'aide des commandes de script. 

Pour indiquer dans un script '{opsi-winst}' que l'installation a échoué, nous devons appeler la déclaration: +
`isFatalError` +
Si cette déclaration est appelé, '{opsi-winst}' arrête l'exécution normale du script et définit le résultat du produit à 'failed' (sinon il est 'success'). +

Disponible depuis 4.11.3.2 il y a une nouvelle variante de cette commande:

* `isFatalError` <chaîne> +
dans ce cas, une chaîne avec un court message d'erreur est transmise en tant que 'actionProgress' au serveur opsi et est affiché dans opsi-configed.

[[opsi-winst-commands-logging]]
==== Commandes pour contrôler la journalisation

* `includelog` <nom du fichier> <taille de la queue>   //since 4.11.2.1 +
Inclut le fichier <nom du fichier> en tant que fichier journal, où les dernières lignes <taille de la queue> du journal complet sont écrites dans ce fichier log.  Si vous lancez un autre programme qui produit un fichier journal, vous pourriez voir que d'autres fichiers journal du programme dans le script opsi-winst journalisent à l'aide de cette commande. + 
Disponible depuis 4.11.3.2, une <taille de la queue> négative peut être proposée, qui va alors inclure les premières lignes <taille de la queue> à partir de la partie supérieure du fichier journal (dit mode 'Head'). + 
Exemple: 
[source,winst]
----
includelog "%Scriptpath%\test-files\10lines.txt" "5"
----

[[opsi-winst-secsections]]
=== Sections Secondaires

[[opsi-winst-patches]]
==== Sections Patch


[[opsi-winst-patches-params]]
===== Paramètre d'Appel 

Les nom du fichier à patcher est passé en paramètre.

Il y a des modificateurs facultatifs:

* `/AllNTUserProfiles` +
Si une section patch est appelé avec ce modificateur, tous les sous-répertoires de `%UserProfileDir%` seront patchés, ce qui signifie que ce patch est effectué pour tous les profils d'utilisateurs. +
Lorsqu'un 'Patches' est appelée dans une section `[ProfileActions]`, le modificateur `/AllNTUserProfiles` est implicite. En mode logscript, `%UserProfileDir%` sera interprété comme `%CurrentProfileDir%`. +
(Disponible depuis 4.11.3.2)

[[opsi-winst-execwith]]
==== Sections ExecWith

Si vous appelez une section ExecWith avec l'interprète 'powershell', le contenu de la section est stocké dans un fichier temporaire avec l'extension `.ps1`. 

[[opsi-winst-winbatch]]
==== Sections WinBatch

[[opsi-winst-winbatch-params]]
===== Paramètre d'Appel (Modificateur)

* `/WaitSeconds` [nombre de secondes] +
Si un appel inclut le paramètre /WaitSeconds [nombre de secondes], alors '{opsi-winst}' attend [nombre de secondes] avant de procéder. Dans la configuration par défaut, nous attendons que tous les programmes en cours d'exécution vont finir. Si nous combinons le paramètre /WaitSeconds avec l'option `/LetThemGo`, '{opsi-winst}' continue le traitement après que le temps d'attente est terminé.
 
* `/WaitForProcessEnding` <nom du programme> +
Attend que le processus appelé <nom du programme> se termine. +
Doit être combinée avec `/TimeOutSeconds`.

Explication: +
Lors du démarrage d'un processus externe à partir d'un appel WinBatch, '{opsi-winst}' attend que le processus actuel soit fini avant d'exécuter la commande suivante dans le script.

.Traitement séquentiel d'un script qui attend la fin d'un programme
image::../images/waitforprocess_scheme_std.png["waitforprocess_scheme_std", scaledwidth="50%"]

Il y a quelques programmes externes qui commencent un autre processus puis se terminent sans attendre la fin de leur processus enfant. Du point de vue de '{opsi-winst}', le processus est terminé et la commande suivante peut être démarré.

.Fin du processus, tandis que le processus enfant est toujours en cours
image::../images/waitforprocess_scheme_fork1.png["waitforprocess_scheme_fork1", scaledwidth="50%"]

Si vous exécutez un programme de désinstallation et un programme d'installation successivement et le programme de désinstallation fonctionne avec un tel processus enfant, vous pouvez avoir des processus en cours d'exécution en conflit parce que la désinstallation et l'installation sont en cours d'exécution au même moment.

.Chevauchement d'un processus enfant et d'un processus parent
image::../images/waitforprocess_scheme_fork2.png["waitforprocess_scheme_fork2", scaledwidth="50%"]

L'utilisation du modificateur `/WaitForProcessEnding` permet d'éviter une telle situation.

* `/TimeOutSeconds` <secondes> +
Un paramètre de temporisation. Après avoir attendu le nombre de <secondes>, '{opsi-winst}' mettra fin au processus. +
Depuis la version 4.11.3, /TimeOutSeconds peut être utilisé sans une condition d'attente (ex. `/WaitForProcessEnding`) mais pas en combinaison avec `/WaitSeconds`. +
Exemple: +
[source,winst]
----
Winbatch_uninstall /WaitForProcessEnding "uninstall.exe" /TimeOutSeconds 20
[Winbatch_uninstall]
"%ScriptPath%\uninstall_starter.exe"
----

* `/RunElevated` +
Commence un processus qui a un jeton de sécurité avec des privilèges élevés. Ce modificateur est soumis aux restrictions suivantes: +
** Pour NT5 cela ne change rien.
** Un processus commencé avec ce modificateur n'a pas accès au réseau. Donc, vous devriez copier un programme dans un répertoire temporaire local, mais ne pas le démarrer à partir d'un partage réseau.
** Vous pouvez voir des problèmes lors de l'utilisation de l'interface graphique. Par conséquent des véritables installations silencieuses sont le meilleur choix dans ce cas.
** Fonctionne uniquement dans le cadre de '{opsi-winst}'.

*  `getLastExitCode` +
Retourne une chaîne qui contient la valeur du code de sortie du processus qui a été le dernier appelé par une section WinBatch / DosBatch / ExecWith. +
Lorsque vous utilisez une section DosBatch ou ExecWith, vous obtiendrez normalement le code de sortie de l'interpréteur qui a été appelé. Pour obtenir le code de sortie de votre script, vous devez le définir explicitement.


=== Miscellaneous

* wisynth: TuibInstScript.doInfo: remplissage optimal pour LabelInfo

* nom du produit installé représenté dans le bloc d'informations initiale. correction du bug #367

* wisynth: executeWith: utilise l'extension '.ps1' si l'interpréteur = powershell, correction du bug #382

* les fichiers de journalisation ne sont pas verrouillées pour la lecture (revenir à l'ancienne méthode) alors que opsi-winst est en cours
                         fixes: https://forum.opsi.org/viewtopic.php?f=7&t=3655
                         
* winbatch: tests pour déterminer si une extension de fichier est exécutable ou com, et n'est pas sensible à la casse.
         fixes: https://forum.opsi.org/viewtopic.php?f=7&t=3592#p18127
         
* Winbatch: Le paramètre de /timeoutseconds peut-être maintenant une variable. correction du bug #352

[[opsi-402-2-releasenotes-misc]]
== Miscellanées

[[opsi-402-2-releasenotes-misc-changelogs]]
=== Changelogs:

[[opsi-402-2-releasenotes-misc-changelogs-configed]]
==== Changelog opsi-configed

opsi-configed (4.0.2.5.8-1) stable;  urgency=low

  * fixed: host groups were not reloaded on reload request

 -- Rupert Roeder <r.roeder@uib.de>  Mon, 15 Oct 2012 12:00:00 +0200

opsi-configed (4.0.2.5.6-1) stable;  urgency=low

  * fixed: problem  when server property is missing
  * fixed: a new client must not have the name of the opsi server (or depots)

 -- Rupert Roeder <r.roeder@uib.de>  Wed, 26 Sep 2012 12:00:00 +0200

opsi-configed (4.0.2.5.5-1) stable;  urgency=low

  * fixed: some problem when changing between not synchronized depots

 -- Rupert Roeder <r.roeder@uib.de>  Fri, 07 Sep 2012 18:00:00 +0200


opsi-configed (4.0.2.4-1) stable  urgency=low

	* updated FR language file
	* eliminated NPEs for not authenticated users

-- Rupert Roeder <r.roeder@uib.de>  Thu, 16 Aug 2012 11:38:32 +0200

opsi-configed (4.0.2.2-1) testing; urgency=low

	* new button indication of existing product property entries
	* new client action resetLocalProducts

-- Rupert Roeder <r.roeder@uib.de>  Thu, 16 Jul 2012 11:38:32 +0200

opsi-configed (4.0.2.1-1) testing; urgency=low

	* calls to hostControl_reachable and hostControl_getActiveSessions are made threaded
    to avoid blocking of the configed if there are problems
  * improvements in gui of client search dialogs
  * added support of description field for a saved search
  * added support of description field for tree groups
  * new button indication of existing product property entries
  * new client action resetLocalProducts

-- Rupert Roeder <r.roeder@uib.de>  Thu, 20 Jun 2012 14:38:32 +0200

opsi-configed (4.0.2.0-1) testing; urgency=low

  * implementation of DIRECTORY extension of treeview
  * coloring of product versioninfo which are not equal to the server version
  * report column can now be edited (by transforming the values to values of
    ActionResult, ActionProgress, LastState
  * product properties and host configs are marked by bold font when not being identical with the default values
  * an additional product column showing the (full) product names can be used
  * if a opsi client is created there now is a check for existing host names which will not be reused without confirmation
  * new sorting of depots, tooltip added for depots

-- Rupert Roeder <r.roeder@uib.de>  Thu, 14 Jun 2012 14:38:32 +0200

opsi-configed (4.0.1.27-1) testing; urgency=low

  * improved window handling of client selection dialog

-- Rupert Roeder <r.roeder@uib.de>  Thu, 03 May 2012 14:38:32 +0200

opsi-configed (4.0.1.26-1) testing; urgency=low

  * bugfix: product properties are reloaded for each selected client if a
    product was selected

-- Rupert Roeder <r.roeder@uib.de>  Thu, 26 Apr 2012 14:38:32 +0200

opsi-configed (4.0.1.25-1) testing; urgency=low

  * improvement: Added a new client selection dialog

-- Felix Rohrbach <fxrh@gmx.de> Wed, 21 Mar 2012  14:38:32 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-winst]]
==== Changelog opsi-winst

opsi-winst (4.11.3.3) stable; urgency=low
  * new command setActionProgress <string>
  * commandline parameter /productid <string>
      This parameter forces the winst to try to start a service connection using the
      local opsiclientd.conf. This will be used in the opsi-template-with-admin
      to run the local script in opsi context
  * Versioninfo: try to find informations also on other than the stored codepage
  * wisynth: doRegistryAllNTUserDats: use getProfilesDirList
  * widatamodul: retrieveJSONObject: JSON Bench Log entry for every service call
  * wimain: saveVersionToProfile/readVersionFromProfile :
      if there is no access to Appdata, we use the profile directory for the .opsi.org\userLoginScripts.ini
  * wilog: PartOpenForReading: fix for timing problem 'Floatingpoint Underflow'
-- Detlef Oertel <d.oertel@uib.de>  Thu,  13 Sep 2012:15:00:00 +0200

opsi-winst (4.11.3.2) stable; urgency=low

  * new command FatalOnSyntaxError (default= true)
  * every script syntax error is logged
  * every script syntax error increases the errorcounter
  * if FatalOnSyntaxError then every script syntax error is a fatal error
       and 'Syntax Error' is set as actionProgress
  * now isFatalError accepts a string which is stored to the server as actionprogress and showed in the opsi-configed
  * includeLogFile now works in head mode if you give a negative number as line count
       ** changed in TLogInfo.includelogtail
  * new stringlist function: getProfilesDirList: All existing Profiles dirs except:
            'localservice','networkservice','systemprofile'
  * Patches sections may now called with  %userprofiledir% as part of the file name and /AllNTuserProfiles
     so it will run on all profiles.
     If running in Machine mode, the '/AllNTuserProfiles' is implizit in the [ProfileActions].
     If running in LoginScript mode, the '%userprofiledir%' is the %CurrentProfileDir%.
  * new stringfunction: GetIpByName(<ip addr / ip name>) : string
  * Files sections changed: wisynth: doFileActions:
      Modifier /AllNtUserProfiles and /AllNtUserSendto now based on getProfilesDirList
  * new stringlist commands to retrieve maps from the registry:
    ** getRegistryVarMap32(<regkey>)
    ** getRegistryVarMap64(<regkey>)
    ** getRegistryVarMapSysnative(<regkey>)
  * winbatch: (Startprocess*) catching exceptions if execute bit is missing on samba4 shares

-- Detlef Oertel <d.oertel@uib.de>  Mon,  30 Jul 2012:15:00:00 +0200

opsi-winst (4.11.3.1) stable; urgency=low

  * winbatch: /timeoutseconds now allowed without /waitforprocessending (not with /waitsec)
  * Winbatch: The parameter to /timeoutseconds may now be a variable fixes #352
  * winbatch /RunElevated
  * patchhosts sections: 64 bit compatibility, fixes #327
  * manifest added: <requestedExecutionLevel level="highestAvailable" />: +
         http://www.lazarus.freepascal.org/index.php?topic=14976.0 +
         http://lazarus.freepascal.org/index.php/topic,11659.msg69861.html +
         http://msdn.microsoft.com/en-us/library/bb756929.aspx
  * new stringfunction: getDiffTimeSec (Time in seconds since last marktime)
  * name of installing product shown in inital info block. fixes #367
  * Exitcode of DosBatch, Execwith is now logged and can be retrieved by getLastExitcode
      ** be aware: this is the exitcode of the called program so use something like:
         exit %ERRORLEVEL% , fixes #161
  * on userLoginScript: retry if there no user could be detected
  * wisynth: TuibInstScript.doInfo: optimal fill for LabelInfo
  * wisynth: executeWith: use extension '.ps1' if interpreter = powershell, fixes #382
  * new function: NormalizeWinst (set normal window state), fixes #346
  * old function IconizeWinst  (set minimized window state), fixes #346
  * old function RestoreWinst  (set maximized window state), fixes #346
  * new stringfunction: stringReplace(string, oldPattern,newPattern) : string ; +
    this function replaces all occurrences of one substring with another in a string +
    it works not case sensitive , fixes #328
  * new stringfunction: GetMyIpByTarget(<target ip addr>) : string
  * new boolean function: contains(<str>, <substr>) : boolean ; case sensitive, fixes #365
  * old boolean function: isNumber(<str>) : boolean
  * new stringlist function: getProductPropertyList(<propname>,<default value>)
  * wispecfolder: fix using winapi call GetDefaultUserProfileDirectory for %DefaultUserProfileDir%
  * wispecfolder: fix using winapi call GetAllUsersProfileDirectory for %CommonProfileDir%
  * new stringfunction SidToName(<well known sid>) : gives localized name of the sid
  * wisynt: try-except in doRegistryHackRegeditFormat
  * logfiles now again not locked against reading while opsi-winst is running +
                         fixes: https://forum.opsi.org/viewtopic.php?f=7&t=3655
  * new commands:
       include_insert "<file name>"   : Replaces the command with a empty line
                                         and then inserts the content of "<file name>" after this line
       include_append "<file name>"   : Replaces the command with a empty line
                                         and then appends the the content of "<file name>"
                                         to the end of the script
       **  <file name> is either:
         *** a complete valid Path
         *** The name of a file in %WinstDir%\lib
         *** The name of a file in %ScriptPath%
       ** should be placed after requiredWinstVersion

  * new stringlist commands to retrieve lists from the registry:
    ** getRegistryKeyList32(<regkey>)
    ** getRegistryKeyList64(<regkey>)
    ** getRegistryKeyListSysnative(<regkey>)
    ** getRegistryVarList32(<regkey>)
    ** getRegistryVarList64(<regkey>)
    ** getRegistryVarListSysnative(<regkey>)

  * new stringfunction strLength(<string>)
  * new stringfunction strPos(<string>, <substr>)
  * new stringfunction strPart(<string>, <start pos>, <number of chars>)

  * winbatch: test if extension of exitsting file is exe or com now not case sensitive.
         fixes: https://forum.opsi.org/viewtopic.php?f=7&t=3592#p18127

-- Detlef Oertel <d.oertel@uib.de>  Tue,  11 Jan 2012:15:00:00 +0200

opsi-winst (4.11.2.12) stable; urgency=low

        * fix for getproductmap widatamodul: TOpsi4Data.initProduct: reset FProductOnClient_aktobject with nil

-- Detlef Oertel <d.oertel@uib.de>  Tue,  31 Jul 2012:15:00:00 +0200

opsi-winst (4.11.2.11) stable; urgency=low

        * wispecfolder: fix for the fix using winapi call GetProfilesDirectory for %profiledir%

-- Detlef Oertel <d.oertel@uib.de>  Tue,  3 Jun 2012:15:00:00 +0200

opsi-winst (4.11.2.10) stable; urgency=low

        * wispecfolder: fix using winapi call GetProfilesDirectory for %profiledir%

-- Detlef Oertel <d.oertel@uib.de>  Tue,  2 Jun 2012:15:00:00 +0200

[[opsi-402-2-releasenotes-misc-changelogs-hwaudit]]
==== Changelog hwaudit

hwaudit (4.0.5-1) stable; urgency=low

  * added dell-expresscode to computer_system
  * added productProperty loglevel log-file
  * changeDirectory added (package requires now winst: 4.11.2.6)
  * new temp-Directory C:\opsi.org\tmp instead of old C:\tmp

-- Erol Ueluekmen <e.ueluekmen@uib.de>  31 Jul 2012

hwaudit (4.0.4-3) stable; urgency=low

  * get timeout from property
  * Ticketid 2012021510000025

-- Bardo Wolf <b.wolf@uib.de>  23 Feb 2012

hwaudit (4.0.4-3) stable; urgency=low
  
  * get timeout from property
  * Ticketid 2012021510000025

-- Bardo Wolf <b.wolf@uib.de>  23 Feb 2012


hwaudit (4.0.4-2) stable; urgency=low
  
  * get timeout from property
  * Ticketid 2012021510000025

-- Bardo Wolf <b.wolf@uib.de>  23 Feb 2012

[[opsi-402-2-releasenotes-misc-changelogs-swaudit]]
==== Changelog swaudit

swaudit (4.0.2-1) stable; urgency=low

  * code cleanup
  * remove all opsi 3 stuff
  * use opsi-winst 4.11.3 methods
  * extended search off by default (no data at NT6)
  * replace delete by del
  * replace c:\tmp by c:\opsi.org\tmp

-- detlef oertel <d.oertel@uib.de>  Fri, 10 Aug 2012 15:00:00 +0100


swaudit (4.0-15) testing; urgency=low

  * new property: readfromfile to switch off audit and use the filebuffer files instead
    ONLY DEBUG - do not use if you are not sure what you doing! (Do not make a audit but read values from c:\tmp and send them)

-- detlef oertel <d.oertel@uib.de>  Fri, 11 May 2012 15:00:00 +0100


swaudit (4.0-14) testing; urgency=low

  * workaround for bug#354 (set version to '' if zero) deleted because it is fixed

-- detlef oertel <d.oertel@uib.de>  Tue, 26 Apr 2012 16:00:00 +0100

swaudit (4.0-13) testing; urgency=low

  * set version to '' if zero - workaround for bug#354

-- detlef oertel <d.oertel@uib.de>  Tue, 15 Mar 2012 16:00:00 +0100

swaudit (4.0-12) testing; urgency=low

  * new property: usekeyfinder to switch off keyfinder call

-- detlef oertel <d.oertel@uib.de>  Tue, 29 Nov 2011 16:00:00 +0100

[[opsi-402-2-releasenotes-misc-changelogs-jedit]]
==== Changelog jedit

jedit_4.5.2-2 stable; urgency=low

   * opsi-winst.xml for version 4.11.3.2

-- detlef oertel <d.oertel@uib.de>  Tue, 31 Jul 2012 16:01:53 +0200

jedit_4.5.2-1 stable; urgency=low

   * update to version 4.5.2
   * opsi-winst.xml for version 4.11.3.1
   * opsi-winst.xml for *ins,*.opsiscript,*opsiinc

-- detlef oertel <d.oertel@uib.de>  Thu, 12 Jul 2012 16:01:53 +0200
  
jedit_4.5.1-1 stable; urgency=low

   * update to version 4.5.1
   * property gui_language description:  jedit localization
   values: ["auto", "de", "en", "fr"]
   default: ["en"]

-- bardo wolf <b.wolf@uib.de>   12 Jun 2012 


[[opsi-402-2-releasenotes-misc-changelogs-opsi-adminutils]]
==== Changelog opsi-adminutils

opsi-adminutils (4.0.2.1-1) stable; urgency=low

  * replace ussf by opsi-setup-detector
  * update auf InstEd-1.5.15.26.msi
  * winscp 4.3.9

-- detlef oertel <d.oertel@uib.de>  06 Aug 2012


opsi-adminutils (4.0.1.24-1) stable; urgency=low

  * try to fix [ 2012031610000012 ] opsi-adminutils webstart funktioniert nicht.
  * postinst check if newer configed.jar swingx.jar on server
  * winscp 4.3.7
  * property javaweb installer or local configed
  * swingx.jar
  * configed.jar 4.0.1.24
  * language selection
  * replace %ProgramfilesDir% by %Programfiles32Dir%

-- Bardo Wolf <b.wolf@uib.de>  16 Mar 2012
  
opsi-adminutils (4.0.1.12-4) stable; urgency=low

  * corrected linkfolder for opsi-configed
  
-- Rupert Röder <r.roeder@uib.de>  07 Mar 2012

opsi-adminutils (4.0.1.12-3) stable; urgency=low

  * putty 0.62
  * winscp 4.3.5
  
-- Susanne Ehlers <s.ehlers@uib.de> 13 Dec 2011

opsi-adminutils (4.0.1.12-2) stable; urgency=low

  * JXv3.1 replaced by jxplorer-3.2.2-windows-installer.exe
  
-- Bardo Wolf <b.wolf@uib.de>  17 Oct 2011

[[opsi-402-2-releasenotes-misc-changelogs-opsi-template]]
==== Changelog opsi-template

opsi-template (4.0.2-2) stable; urgency=low

	* requiredWinstVersion >= "4.11.3.2"
	* Set $LogDir$ = "%SystemDrive%\opsi.org\tmp"
	* new: *_short32.opsiscript scripts with includes
	* winbatch_install: changed inno-setup example: default without answer file
	* winbatch_uninstall: changed NSIS example: /WaitForProcessEnding "Au_.exe"

-- detlef oertel <d.oertel@uib.de>  Fri, 03 Aug 2012 16:01:53 +0200

opsi-template (4.0.2-1) stable; urgency=low

	* requiredWinstVersion >= "4.11.2.6"
	* added ChangeDirectory "%SCRIPTPATH%"
	* changed delete to del (in delsub)
	* changed at msi to ALLUSERS=1

-- detlef oertel <d.oertel@uib.de>  Mon, 02 Jun 2012 16:01:53 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-template-with-admin]]
==== Changelog opsi-template-with-admin

opsi-template-with-admin (4.0.2-2) stable; urgency=low

	* requires opsi-winst >= 4.11.3.3
	* uses /productid switch at opsi-winst call
	* code cleanup (use of synative instead of 64bit)
	* property debug: switches loglevel and lock keyboard
	* code cleanup

-- detlef oertel <d.oertel@uib.de>  Thu, 19 Sep 2012 15:01:53 +0200

opsi-template-with-admin (4.0.2-1) stable; urgency=low

	* requires opsi-winst >= 4.11.3
	* using SidToName instead of psgetsid.exe
	* priority set to -20  
	* first reboot is commented (;ExitWindows /ImmediateReboot). Uncomment it if you have problems with the autologon

-- detlef oertel <d.oertel@uib.de>  Wed, 04 Jul 2012 15:01:53 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-client-agent]]
==== Changelog opsi-client-agent

opsi-client-agent (4.0.2.1-2) stable; urgency=low

  * no interactive message on copy error if $INST_SubModus$="CREATE_CLIENT"
  * opsi-winst 4.11.3.2
  * use of GetMyIpByTarget()
  * use of GetIpByName()
  * devided Files_redist_cleanup to Files_redist_cleanup_c and Files_redist_cleanup_d

-- Detlef Oertel <d.oertel@uib.de>  Mon, 4 Jun 2012 15:00:00 +0100

[[opsi-402-2-releasenotes-misc-changelogs-windows-netboot]]
==== Changelog windows Netboot Products

windows (4.0.2-1) stable; urgency=low

  * Security fix in net mount while winpe works (NT6)
  * set alignment for partitions (NT5)
  * show_drivers.py modified to show automated including additional driver over inventory
  * create_driver_links for handling with fileadmingroup from opsi.conf-file

-- uib GmbH <info@uib.de>  Fr, 29 Jun 2012 15:19:15 +0000

windows (4.0.1-11) stable; urgency=low

  * fix in multilanguage control file (time zone)
  * fix image names windows server

-- uib GmbH <info@uib.de>  Mon, 2 Apr 2012 15:19:15 +0000

windows (4.0.1-10) stable; urgency=low

  * multilanguage control file
  * additional locales and keyboard layouts

-- uib GmbH <info@uib.de>  Tue, 24 Jan 2012 14:19:15 +0000

windows (4.0.1-9) stable; urgency=low

  * blockAlignment added.

-- uib GmbH <info@uib.de>  Wed, 16 Nov 2011 11:06:24 +0000

windows (4.0.1-8) stable; urgency=low

  * descriptions now english
  * Added new properties for patching unattend.xml Component Microsoft-Windows-International-Core-WinPE
      winpe_uilanguage
      winpe_uilanguage_fallback
      winpe_inputlocale
  * added new properties to  unattend.xml.template
  * show_drivers.py

-- bardo wolf <b.wolf@uib.de>  Mon, 31 Oct 2011 09:09:50 +0000

windows (4.0.1-7) stable; urgency=low

  * unattend.xml patched for postinst-routines like 2008-r2
  * show_drivers.py modified to show right list of drivers; now with messages for duplicate drivers.

-- uib GmbH <info@uib.de>  Thu, 22 Sep 2011 14:19:15 +0000

windows (4.0.1-6) stable; urgency=low

  * Remove Display settings from unattend.xml.template

-- uib GmbH <info@uib.de>  Thu, 25 Aug 2011 12:25:50 +0000

windows (4.0.1-5) stable; urgency=low

  * Call auditHardwareOnHost_setObsolete

-- uib GmbH <info@uib.de>  Tue, 19 Jul 2011 13:17:02 +0000

windows (4.0.1-4) stable; urgency=low

  * Modify driver integration

-- uib GmbH <info@uib.de>  Mon, 18 Jul 2011 15:05:10 +0000

[[opsi-402-2-releasenotes-misc-changelogs-python-opsi]]
==== Changelog python-opsi

python-opsi (4.0.2.4-1) stable; urgency=low

  * fixes method setProductActionRequestWithDependencies after host_createOpsiClient
  * added default dhcp string and text options that the values will be set in double-quotes (fixes#403)
  * added method userIsReadOnlyUser()
  * WindowsDriverIntegration: do not break when no devices found in txtsetup.oem (corrupted txtsetup.oem)

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 27 Sep 2012 10:35:17 +0200

python-opsi (4.0.2.3-1) testing; urgency=low

  * Workaround for bootimage: wait if blockfile to partition does not exist.
  * Automated additional-driver integration support.
  * hostControl-Fix for host_reachable method.
  * added opsiFileAdminhandling, added new opsi.conf File.
  * dellexpresscode for hwinvent implemented
  * licensekey length increased to 1024

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 17 Jul 2012 13:33:13 +0200

python-opsi (4.0.2.2-1) testing; urgency=low

  * Workaround for python 2.7 in jsonrpc-backend: compressed data will send as bytearray
  * fix for isc-dhcp-server for oneiric and precise

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Mon, 11 Jun 2012 13:42:58 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsipxeconfd]]
==== Changelog opsipxeconfd

opsipxeconfd (4.0.2.6-1) stable; urgency=low

  * Fix: if always switched to none, don't create new pipe for client.

-- e.ueluekmen@uib.de <erol@erollinux.uib.local>  Mon, 08 Oct 2012 14:42:45 +0200

opsipxeconfd (4.0.2.5-1) experimental; urgency=low

  * Fix: dont lose append entry from template, if no productProperty set

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 25 Sep 2012 14:48:08 +0200

opsipxeconfd (4.0.2.4-1) experimental; urgency=low

  * write pipe again, if product has set always actionRequest for client.

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 18 Sep 2012 18:27:36 +0200

opsipxeconfd (4.0.2.3-1) experimental; urgency=low

  * when spaces are in append, does not shuffle productPropertyStates

-- Jim Pizagno <j.pizagno@uib.de>  Wed, 05 Sep 2012 17:03:22 +0200

opsipxeconfd (4.0.2.2-1) testing; urgency=low

  * fixing init.d lsb-header for SUSE based servers. Removing runlevel 4
  * fileadmingroup added in /etc/opsi/backends/file.conf

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Fri, 22 Jun 2012 16:26:42 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsiconfd]]
==== Changelog opsiconfd

opsiconfd (4.0.2.4-1) stable; urgency=low

  * added readOnly-State in session and worker

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 04 Oct 2012 11:18:36 +0200

opsiconfd (4.0.2.3-1) testing; urgency=low

  * fixing floatdivision in statistics-class

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Wed, 18 Jul 2012 17:05:54 +0200

opsiconfd (4.0.2.2-1) testing; urgency=low

  * omb: python 2.4 fixing import hashlib
  * fixing init.d lsb-header for SUSE based servers. Removing runlevel 4

-- Erol Ueluekmen <e.euluekmen@uib.de>  Fri, 22 Jun 2012 15:06:59 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-utils]]
==== Changelog opsi-utils
             
opsi-utils (4.0.2.3-1) stable; urgency=low

  * opsi-product-updater: Fix for using more then one repositories with different onlyDownload options.

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 11 Oct 2012 14:13:35 +0200

opsi-utils (4.0.2.2-1) testing; urgency=low

  * Added opsiFileAdminGroup handling.
  * opsi-product-updater: Timestamps in Mail

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 19 Jul 2012 11:44:37 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-linux-bootimage]]
==== Changelog opsi-linux-bootimage

opsi-linux-bootimage (20120728-1) experimental; urgency=low

  * kernel 3.5
  * python-opsi 4.0.2.3-1

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Mon, 16 Jul 2012 16:42:42 +0200

opsi-linux-bootimage (20120119-1) stable; urgency=low

  * kernel 3.2.1
  * fix french-localisation
  * added gptfdisk toolset
  * python-opsi 4.0.1.37-1

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 19 Jan 2012 15:01:04 +0100

[[opsi-402-2-releasenotes-misc-changelogs-opsi-depotserver]]
==== Changelog opsi-depotserver

opsi-depotserver (4.0.2.3-1) stable; urgency=low

  * Config-default-creation by first running --init-current-config fixed

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 18 Sep 2012 17:42:23 +0200
 
opsi-depotserver (4.0.2.2-1) quantal; urgency=low

  * Added opsiFileAdmins handling.

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 19 Jul 2012 11:46:20 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi4ucs]]
==== Changelog opsi4ucs

opsi4ucs (4.0.2.3-1) stable; urgency=low

  * Join script modified:
      - only patch dhcp if it's installed
      - restart and patch samba4 only, if samba4 is installed
  * don't build opsi4ucs-ldap-schema.

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 02 Oct 2012 15:14:44 +0200

opsi4ucs (4.0.2.2-1) experimental; urgency=low

  * For handling with new pcpatch-group added opsi.conf.
  * UCSOverview-page changed from applet to java-webstart.
  * Added new opsi-auth pam module for UCS 3

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Thu, 24 Aug 2012 10:17:21 +0200

opsi4ucs (4.0.2.1-1) testing; urgency=low

  * Featurepack-Release 4.0.2 for ucs.
  * First Release for UCS 3 Support:
      - uninvetion-ldap-backend have reached his EOL since ucs3 (default backend: file)
  * Fixes 99opsi4ucs.inst-Joinscript

-- Erol Ueluekmen <e.ueluekmen@uib.de>  Fri, 29 Jun 2012 10:13:10 +0200

[[opsi-402-2-releasenotes-misc-changelogs-opsi-atftp]]
==== Changelog opsi-atftp

opsi-atftp (0.7.dfsg-2) stable; urgency=low

  * fix uncommented entries for tftp-service in inetd.conf

 -- Erol Ueluekmen <e.ueluekmen@uib.de>  Fri, 12 Oct 2012 13:25:16 +0200

opsi-atftp (0.7.dfsg-1.9) testing; urgency=low

  * Replaces univention-tftp package

 -- Erol Ueluekmen <e.ueluekmen@uib.de>  Fri, 10 Aug 2012 11:21:13 +0200

opsi-atftp (0.7.dfsg-1.8) stable; urgency=low

  * LSB Header added in init-script

 -- Erol Ueluekmen <e.ueluekmen@uib.de>  Tue, 24 Jan 2012 18:01:39 +0100




